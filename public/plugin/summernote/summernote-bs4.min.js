/*!
 * 
 * Super simple wysiwyg editor v0.8.18
 * https://summernote.org
 * 
 * 
 * Copyright 2013- Alan Hong. and other contributors
 * summernote may be freely distributed under the MIT license.
 * 
 * Date: 2020-05-20T18:09Z
 * 
 */
!function webpackUniversalModuleDefinition(root,factory){if("object"==typeof exports&&"object"==typeof module)module.exports=factory(require("jquery"));else if("function"==typeof define&&define.amd)define(["jquery"],factory);else{var a="object"==typeof exports?factory(require("jquery")):factory(root.jQuery);for(var i in a)("object"==typeof exports?exports:root)[i]=a[i]}}(window,(function(__WEBPACK_EXTERNAL_MODULE__0__){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=53)}({0:function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE__0__},1:function(module,__webpack_exports__,__webpack_require__){"use strict";var jquery__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),jquery__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}var Renderer=function(){function Renderer(markup,children,options,callback){_classCallCheck(this,Renderer),this.markup=markup,this.children=children,this.options=options,this.callback=callback}return _createClass(Renderer,[{key:"render",value:function render($parent){var $node=jquery__WEBPACK_IMPORTED_MODULE_0___default()(this.markup);if(this.options&&this.options.contents&&$node.html(this.options.contents),this.options&&this.options.className&&$node.addClass(this.options.className),this.options&&this.options.data&&jquery__WEBPACK_IMPORTED_MODULE_0___default.a.each(this.options.data,(function(k,v){$node.attr("data-"+k,v)})),this.options&&this.options.click&&$node.on("click",this.options.click),this.children){var $container=$node.find(".note-children-container");this.children.forEach((function(child){child.render($container.length?$container:$node)}))}return this.callback&&this.callback($node,this.options),this.options&&this.options.callback&&this.options.callback($node),$parent&&$parent.append($node),$node}}]),Renderer}();__webpack_exports__.a={create:function create(markup,callback){return function(){var options="object"===_typeof(arguments[1])?arguments[1]:arguments[0],children=Array.isArray(arguments[0])?arguments[0]:[];return options&&options.children&&(children=options.children),new Renderer(markup,children,options,callback)}}}},2:function(module,exports){(function(__webpack_amd_options__){module.exports=__webpack_amd_options__}).call(this,{})},3:function(module,__webpack_exports__,__webpack_require__){"use strict";var external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_=__webpack_require__(0),external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default=__webpack_require__.n(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_);external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote||{lang:{}},external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.extend(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.lang,{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",size:"Font Size",sizeunit:"Font Size Unit"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize full",resizeHalf:"Resize half",resizeQuarter:"Resize quarter",resizeNone:"Original size",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Remove float",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image",original:"Original"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window",useProtocol:"Use default protocol"},table:{table:"Table",addRowAbove:"Add row above",addRowBelow:"Add row below",addColLeft:"Add column left",addColRight:"Add column right",delRow:"Delete row",delCol:"Delete column",delTable:"Delete table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",p:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Text Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default",cpSelect:"Select"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},help:{escape:"Escape",insertParagraph:"Insert Paragraph",undo:"Undo the last command",redo:"Redo the last command",tab:"Tab",untab:"Untab",bold:"Set a bold style",italic:"Set a italic style",underline:"Set a underline style",strikethrough:"Set a strikethrough style",removeFormat:"Clean a style",justifyLeft:"Set left align",justifyCenter:"Set center align",justifyRight:"Set right align",justifyFull:"Set full align",insertUnorderedList:"Toggle unordered list",insertOrderedList:"Toggle ordered list",outdent:"Outdent on current paragraph",indent:"Indent on current paragraph",formatPara:"Change current block's format as a paragraph(P tag)",formatH1:"Change current block's format as H1",formatH2:"Change current block's format as H2",formatH3:"Change current block's format as H3",formatH4:"Change current block's format as H4",formatH5:"Change current block's format as H5",formatH6:"Change current block's format as H6",insertHorizontalRule:"Insert horizontal rule","linkDialog.show":"Show Link Dialog"},history:{undo:"Undo",redo:"Redo"},specialChar:{specialChar:"SPECIAL CHARACTERS",select:"Select Special characters"},output:{noSelection:"No Selection Made!"}}});var isSupportAmd="function"==typeof define&&__webpack_require__(2),genericFontFamilies=["sans-serif","serif","monospace","cursive","fantasy"];function validFontName(fontName){return-1===external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.inArray(fontName.toLowerCase(),genericFontFamilies)?"'".concat(fontName,"'"):fontName}function env_isFontInstalled(fontName){var testFontName="Comic Sans MS"===fontName?"Courier New":"Comic Sans MS",testText="mmmmmmmmmmwwwww",testSize="200px",canvas,context=document.createElement("canvas").getContext("2d");context.font="200px '"+testFontName+"'";var originalWidth=context.measureText(testText).width,width;return context.font="200px "+validFontName(fontName)+', "'+testFontName+'"',originalWidth!==context.measureText(testText).width}var userAgent=navigator.userAgent,isMSIE=/MSIE|Trident/i.test(userAgent),browserVersion;if(isMSIE){var matches=/MSIE (\d+[.]\d+)/.exec(userAgent);matches&&(browserVersion=parseFloat(matches[1])),(matches=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/.exec(userAgent))&&(browserVersion=parseFloat(matches[1]))}var isEdge=/Edge\/\d+/.test(userAgent),isSupportTouch="ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0,inputEventName=isMSIE?"DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted":"input",env={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:isMSIE,isEdge:isEdge,isFF:!isEdge&&/firefox/i.test(userAgent),isPhantom:/PhantomJS/i.test(userAgent),isWebkit:!isEdge&&/webkit/i.test(userAgent),isChrome:!isEdge&&/chrome/i.test(userAgent),isSafari:!isEdge&&/safari/i.test(userAgent)&&!/chrome/i.test(userAgent),browserVersion:browserVersion,jqueryVersion:parseFloat(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.fn.jquery),isSupportAmd:isSupportAmd,isSupportTouch:isSupportTouch,isFontInstalled:env_isFontInstalled,isW3CRangeSupport:!!document.createRange,inputEventName:inputEventName,genericFontFamilies:genericFontFamilies,validFontName:validFontName};function eq(itemA){return function(itemB){return itemA===itemB}}function eq2(itemA,itemB){return itemA===itemB}function peq2(propName){return function(itemA,itemB){return itemA[propName]===itemB[propName]}}function ok(){return!0}function fail(){return!1}function not(f){return function(){return!f.apply(f,arguments)}}function and(fA,fB){return function(item){return fA(item)&&fB(item)}}function func_self(a){return a}function func_invoke(obj,method){return function(){return obj[method].apply(obj,arguments)}}var idCounter=0;function resetUniqueId(){idCounter=0}function uniqueId(prefix){var id=++idCounter+"";return prefix?prefix+id:id}function rect2bnd(rect){var $document=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(document);return{top:rect.top+$document.scrollTop(),left:rect.left+$document.scrollLeft(),width:rect.right-rect.left,height:rect.bottom-rect.top}}function invertObject(obj){var inverted={};for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(inverted[obj[key]]=key);return inverted}function namespaceToCamel(namespace,prefix){return(prefix=prefix||"")+namespace.split(".").map((function(name){return name.substring(0,1).toUpperCase()+name.substring(1)})).join("")}function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,later=function later(){timeout=null,immediate||func.apply(context,args)},callNow=immediate&&!timeout;clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&func.apply(context,args)}}function isValidUrl(url){var expression;return/[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/gi.test(url)}var func={eq:eq,eq2:eq2,peq2:peq2,ok:ok,fail:fail,self:func_self,not:not,and:and,invoke:func_invoke,resetUniqueId:resetUniqueId,uniqueId:uniqueId,rect2bnd:rect2bnd,invertObject:invertObject,namespaceToCamel:namespaceToCamel,debounce:debounce,isValidUrl:isValidUrl};function lists_head(array){return array[0]}function lists_last(array){return array[array.length-1]}function initial(array){return array.slice(0,array.length-1)}function tail(array){return array.slice(1)}function find(array,pred){for(var idx=0,len=array.length;idx<len;idx++){var item=array[idx];if(pred(item))return item}}function lists_all(array,pred){for(var idx=0,len=array.length;idx<len;idx++)if(!pred(array[idx]))return!1;return!0}function contains(array,item){if(array&&array.length&&item){if(array.indexOf)return-1!==array.indexOf(item);if(array.contains)return array.contains(item)}return!1}function sum(array,fn){return fn=fn||func.self,array.reduce((function(memo,v){return memo+fn(v)}),0)}function from(collection){for(var result=[],length=collection.length,idx=-1;++idx<length;)result[idx]=collection[idx];return result}function lists_isEmpty(array){return!array||!array.length}function clusterBy(array,fn){return array.length?tail(array).reduce((function(memo,v){var aLast=lists_last(memo);return fn(lists_last(aLast),v)?aLast[aLast.length]=v:memo[memo.length]=[v],memo}),[[lists_head(array)]]):[];var aTail}function compact(array){for(var aResult=[],idx=0,len=array.length;idx<len;idx++)array[idx]&&aResult.push(array[idx]);return aResult}function unique(array){for(var results=[],idx=0,len=array.length;idx<len;idx++)contains(results,array[idx])||results.push(array[idx]);return results}function lists_next(array,item){if(array&&array.length&&item){var idx=array.indexOf(item);return-1===idx?null:array[idx+1]}return null}function prev(array,item){if(array&&array.length&&item){var idx=array.indexOf(item);return-1===idx?null:array[idx-1]}return null}var lists={head:lists_head,last:lists_last,initial:initial,tail:tail,prev:prev,next:lists_next,find:find,contains:contains,all:lists_all,sum:sum,from:from,isEmpty:lists_isEmpty,clusterBy:clusterBy,compact:compact,unique:unique},NBSP_CHAR=String.fromCharCode(160),ZERO_WIDTH_NBSP_CHAR="\ufeff";function isEditable(node){return node&&external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(node).hasClass("note-editable")}function isControlSizing(node){return node&&external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(node).hasClass("note-control-sizing")}function makePredByNodeName(nodeName){return nodeName=nodeName.toUpperCase(),function(node){return node&&node.nodeName.toUpperCase()===nodeName}}function isText(node){return node&&3===node.nodeType}function isElement(node){return node&&1===node.nodeType}function isVoid(node){return node&&/^BR|^IMG|^HR|^IFRAME|^BUTTON|^INPUT|^AUDIO|^VIDEO|^EMBED/.test(node.nodeName.toUpperCase())}function isPara(node){return!isEditable(node)&&(node&&/^DIV|^P|^LI|^H[1-7]/.test(node.nodeName.toUpperCase()))}function isHeading(node){return node&&/^H[1-7]/.test(node.nodeName.toUpperCase())}var isPre=makePredByNodeName("PRE"),isLi=makePredByNodeName("LI");function isPurePara(node){return isPara(node)&&!isLi(node)}var isTable=makePredByNodeName("TABLE"),isData=makePredByNodeName("DATA");function dom_isInline(node){return!(isBodyContainer(node)||isList(node)||isHr(node)||isPara(node)||isTable(node)||isBlockquote(node)||isData(node))}function isList(node){return node&&/^UL|^OL/.test(node.nodeName.toUpperCase())}var isHr=makePredByNodeName("HR");function dom_isCell(node){return node&&/^TD|^TH/.test(node.nodeName.toUpperCase())}var isBlockquote=makePredByNodeName("BLOCKQUOTE");function isBodyContainer(node){return dom_isCell(node)||isBlockquote(node)||isEditable(node)}var isAnchor=makePredByNodeName("A");function isParaInline(node){return dom_isInline(node)&&!!dom_ancestor(node,isPara)}function isBodyInline(node){return dom_isInline(node)&&!dom_ancestor(node,isPara)}var isBody=makePredByNodeName("BODY");function isClosestSibling(nodeA,nodeB){return nodeA.nextSibling===nodeB||nodeA.previousSibling===nodeB}function withClosestSiblings(node,pred){pred=pred||func.ok;var siblings=[];return node.previousSibling&&pred(node.previousSibling)&&siblings.push(node.previousSibling),siblings.push(node),node.nextSibling&&pred(node.nextSibling)&&siblings.push(node.nextSibling),siblings}var blankHTML=env.isMSIE&&env.browserVersion<11?"&nbsp;":"<br>";function nodeLength(node){return isText(node)?node.nodeValue.length:node?node.childNodes.length:0}function deepestChildIsEmpty(node){do{if(null===node.firstElementChild||""===node.firstElementChild.innerHTML)break}while(node=node.firstElementChild);return dom_isEmpty(node)}function dom_isEmpty(node){var len=nodeLength(node);return 0===len||(!isText(node)&&1===len&&node.innerHTML===blankHTML||!(!lists.all(node.childNodes,isText)||""!==node.innerHTML))}function paddingBlankHTML(node){isVoid(node)||nodeLength(node)||(node.innerHTML=blankHTML)}function dom_ancestor(node,pred){for(;node;){if(pred(node))return node;if(isEditable(node))break;node=node.parentNode}return null}function singleChildAncestor(node,pred){for(node=node.parentNode;node&&1===nodeLength(node);){if(pred(node))return node;if(isEditable(node))break;node=node.parentNode}return null}function listAncestor(node,pred){pred=pred||func.fail;var ancestors=[];return dom_ancestor(node,(function(el){return isEditable(el)||ancestors.push(el),pred(el)})),ancestors}function lastAncestor(node,pred){var ancestors=listAncestor(node);return lists.last(ancestors.filter(pred))}function dom_commonAncestor(nodeA,nodeB){for(var ancestors=listAncestor(nodeA),n=nodeB;n;n=n.parentNode)if(ancestors.indexOf(n)>-1)return n;return null}function listPrev(node,pred){pred=pred||func.fail;for(var nodes=[];node&&!pred(node);)nodes.push(node),node=node.previousSibling;return nodes}function listNext(node,pred){pred=pred||func.fail;for(var nodes=[];node&&!pred(node);)nodes.push(node),node=node.nextSibling;return nodes}function listDescendant(node,pred){var descendants=[];return pred=pred||func.ok,function fnWalk(current){node!==current&&pred(current)&&descendants.push(current);for(var idx=0,len=current.childNodes.length;idx<len;idx++)fnWalk(current.childNodes[idx])}(node),descendants}function wrap(node,wrapperName){var parent=node.parentNode,wrapper=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<"+wrapperName+">")[0];return parent.insertBefore(wrapper,node),wrapper.appendChild(node),wrapper}function insertAfter(node,preceding){var next=preceding.nextSibling,parent=preceding.parentNode;return next?parent.insertBefore(node,next):parent.appendChild(node),node}function appendChildNodes(node,aChild){return external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(aChild,(function(idx,child){node.appendChild(child)})),node}function isLeftEdgePoint(point){return 0===point.offset}function isRightEdgePoint(point){return point.offset===nodeLength(point.node)}function isEdgePoint(point){return isLeftEdgePoint(point)||isRightEdgePoint(point)}function dom_isLeftEdgeOf(node,ancestor){for(;node&&node!==ancestor;){if(0!==dom_position(node))return!1;node=node.parentNode}return!0}function isRightEdgeOf(node,ancestor){if(!ancestor)return!1;for(;node&&node!==ancestor;){if(dom_position(node)!==nodeLength(node.parentNode)-1)return!1;node=node.parentNode}return!0}function isLeftEdgePointOf(point,ancestor){return isLeftEdgePoint(point)&&dom_isLeftEdgeOf(point.node,ancestor)}function isRightEdgePointOf(point,ancestor){return isRightEdgePoint(point)&&isRightEdgeOf(point.node,ancestor)}function dom_position(node){for(var offset=0;node=node.previousSibling;)offset+=1;return offset}function hasChildren(node){return!!(node&&node.childNodes&&node.childNodes.length)}function dom_prevPoint(point,isSkipInnerOffset){var node,offset;if(0===point.offset){if(isEditable(point.node))return null;node=point.node.parentNode,offset=dom_position(point.node)}else hasChildren(point.node)?offset=nodeLength(node=point.node.childNodes[point.offset-1]):(node=point.node,offset=isSkipInnerOffset?0:point.offset-1);return{node:node,offset:offset}}function dom_nextPoint(point,isSkipInnerOffset){var node,offset;if(nodeLength(point.node)===point.offset){if(isEditable(point.node))return null;var nextTextNode=getNextTextNode(point.node);nextTextNode?(node=nextTextNode,offset=0):(node=point.node.parentNode,offset=dom_position(point.node)+1)}else hasChildren(point.node)?(node=point.node.childNodes[point.offset],offset=0):(node=point.node,offset=isSkipInnerOffset?nodeLength(point.node):point.offset+1);return{node:node,offset:offset}}function nextPointWithEmptyNode(point,isSkipInnerOffset){var node,offset;if(dom_isEmpty(point.node))return{node:node=point.node.nextSibling,offset:offset=0};if(nodeLength(point.node)===point.offset){if(isEditable(point.node))return null;var nextTextNode=getNextTextNode(point.node);nextTextNode?(node=nextTextNode,offset=0):(node=point.node.parentNode,offset=dom_position(point.node)+1),isEditable(node)&&(node=point.node.nextSibling,offset=0)}else if(hasChildren(point.node)){if(offset=0,dom_isEmpty(node=point.node.childNodes[point.offset]))return null}else if(node=point.node,offset=isSkipInnerOffset?nodeLength(point.node):point.offset+1,dom_isEmpty(node))return null;return{node:node,offset:offset}}function getNextTextNode(actual){if(actual.nextSibling&&actual.parent===actual.nextSibling.parent)return isText(actual.nextSibling)?actual.nextSibling:getNextTextNode(actual.nextSibling)}function isSamePoint(pointA,pointB){return pointA.node===pointB.node&&pointA.offset===pointB.offset}function isVisiblePoint(point){if(isText(point.node)||!hasChildren(point.node)||dom_isEmpty(point.node))return!0;var leftNode=point.node.childNodes[point.offset-1],rightNode=point.node.childNodes[point.offset];return!(leftNode&&!isVoid(leftNode)||rightNode&&!isVoid(rightNode))}function prevPointUntil(point,pred){for(;point;){if(pred(point))return point;point=dom_prevPoint(point)}return null}function nextPointUntil(point,pred){for(;point;){if(pred(point))return point;point=dom_nextPoint(point)}return null}function isCharPoint(point){if(!isText(point.node))return!1;var ch=point.node.nodeValue.charAt(point.offset-1);return ch&&" "!==ch&&ch!==NBSP_CHAR}function isSpacePoint(point){if(!isText(point.node))return!1;var ch=point.node.nodeValue.charAt(point.offset-1);return" "===ch||ch===NBSP_CHAR}function walkPoint(startPoint,endPoint,handler,isSkipInnerOffset){for(var point=startPoint;point&&(handler(point),!isSamePoint(point,endPoint));){var isSkipOffset;point=nextPointWithEmptyNode(point,isSkipInnerOffset&&startPoint.node!==point.node&&endPoint.node!==point.node)}}function makeOffsetPath(ancestor,node){var ancestors;return listAncestor(node,func.eq(ancestor)).map(dom_position).reverse()}function fromOffsetPath(ancestor,offsets){for(var current=ancestor,i=0,len=offsets.length;i<len;i++)current=current.childNodes.length<=offsets[i]?current.childNodes[current.childNodes.length-1]:current.childNodes[offsets[i]];return current}function splitNode(point,options){var isSkipPaddingBlankHTML=options&&options.isSkipPaddingBlankHTML,isNotSplitEdgePoint=options&&options.isNotSplitEdgePoint,isDiscardEmptySplits=options&&options.isDiscardEmptySplits;if(isDiscardEmptySplits&&(isSkipPaddingBlankHTML=!0),isEdgePoint(point)&&(isText(point.node)||isNotSplitEdgePoint)){if(isLeftEdgePoint(point))return point.node;if(isRightEdgePoint(point))return point.node.nextSibling}if(isText(point.node))return point.node.splitText(point.offset);var childNode=point.node.childNodes[point.offset],clone=insertAfter(point.node.cloneNode(!1),point.node);return appendChildNodes(clone,listNext(childNode)),isSkipPaddingBlankHTML||(paddingBlankHTML(point.node),paddingBlankHTML(clone)),isDiscardEmptySplits&&(dom_isEmpty(point.node)&&remove(point.node),dom_isEmpty(clone))?(remove(clone),point.node.nextSibling):clone}function splitTree(root,point,options){var ancestors=listAncestor(point.node,func.eq(root));return ancestors.length?1===ancestors.length?splitNode(point,options):ancestors.reduce((function(node,parent){return node===point.node&&(node=splitNode(point,options)),splitNode({node:parent,offset:node?dom_position(node):nodeLength(parent)},options)})):null}function splitPoint(point,isInline){var pred=isInline?isPara:isBodyContainer,ancestors=listAncestor(point.node,pred),topAncestor=lists.last(ancestors)||point.node,splitRoot,container;pred(topAncestor)?(splitRoot=ancestors[ancestors.length-2],container=topAncestor):container=(splitRoot=topAncestor).parentNode;var pivot=splitRoot&&splitTree(splitRoot,point,{isSkipPaddingBlankHTML:isInline,isNotSplitEdgePoint:isInline});return pivot||container!==point.node||(pivot=point.node.childNodes[point.offset]),{rightNode:pivot,container:container}}function dom_create(nodeName){return document.createElement(nodeName)}function createText(text){return document.createTextNode(text)}function remove(node,isRemoveChild){if(node&&node.parentNode){if(node.removeNode)return node.removeNode(isRemoveChild);var parent=node.parentNode;if(!isRemoveChild){for(var nodes=[],i=0,len=node.childNodes.length;i<len;i++)nodes.push(node.childNodes[i]);for(var _i=0,_len=nodes.length;_i<_len;_i++)parent.insertBefore(nodes[_i],node)}parent.removeChild(node)}}function removeWhile(node,pred){for(;node&&!isEditable(node)&&pred(node);){var parent=node.parentNode;remove(node),node=parent}}function dom_replace(node,nodeName){if(node.nodeName.toUpperCase()===nodeName.toUpperCase())return node;var newNode=dom_create(nodeName);return node.style.cssText&&(newNode.style.cssText=node.style.cssText),appendChildNodes(newNode,lists.from(node.childNodes)),insertAfter(newNode,node),remove(node),newNode}var isTextarea=makePredByNodeName("TEXTAREA");function dom_value($node,stripLinebreaks){var val=isTextarea($node[0])?$node.val():$node.html();return stripLinebreaks?val.replace(/[\n\r]/g,""):val}function dom_html($node,isNewlineOnBlock){var markup=dom_value($node);if(isNewlineOnBlock){var regexTag=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;markup=(markup=markup.replace(regexTag,(function(match,endSlash,name){name=name.toUpperCase();var isEndOfInlineContainer=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(name)&&!!endSlash,isBlockNode=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(name);return match+(isEndOfInlineContainer||isBlockNode?"\n":"")}))).trim()}return markup}function posFromPlaceholder(placeholder){var $placeholder=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(placeholder),pos=$placeholder.offset(),height=$placeholder.outerHeight(!0);return{left:pos.left,top:pos.top+height}}function attachEvents($node,events){Object.keys(events).forEach((function(key){$node.on(key,events[key])}))}function detachEvents($node,events){Object.keys(events).forEach((function(key){$node.off(key,events[key])}))}function isCustomStyleTag(node){return node&&!isText(node)&&lists.contains(node.classList,"note-styletag")}var dom={NBSP_CHAR:NBSP_CHAR,ZERO_WIDTH_NBSP_CHAR:"\ufeff",blank:blankHTML,emptyPara:"<p>".concat(blankHTML,"</p>"),makePredByNodeName:makePredByNodeName,isEditable:isEditable,isControlSizing:isControlSizing,isText:isText,isElement:isElement,isVoid:isVoid,isPara:isPara,isPurePara:isPurePara,isHeading:isHeading,isInline:dom_isInline,isBlock:func.not(dom_isInline),isBodyInline:isBodyInline,isBody:isBody,isParaInline:isParaInline,isPre:isPre,isList:isList,isTable:isTable,isData:isData,isCell:dom_isCell,isBlockquote:isBlockquote,isBodyContainer:isBodyContainer,isAnchor:isAnchor,isDiv:makePredByNodeName("DIV"),isLi:isLi,isBR:makePredByNodeName("BR"),isSpan:makePredByNodeName("SPAN"),isB:makePredByNodeName("B"),isU:makePredByNodeName("U"),isS:makePredByNodeName("S"),isI:makePredByNodeName("I"),isImg:makePredByNodeName("IMG"),isTextarea:isTextarea,deepestChildIsEmpty:deepestChildIsEmpty,isEmpty:dom_isEmpty,isEmptyAnchor:func.and(isAnchor,dom_isEmpty),isClosestSibling:isClosestSibling,withClosestSiblings:withClosestSiblings,nodeLength:nodeLength,isLeftEdgePoint:isLeftEdgePoint,isRightEdgePoint:isRightEdgePoint,isEdgePoint:isEdgePoint,isLeftEdgeOf:dom_isLeftEdgeOf,isRightEdgeOf:isRightEdgeOf,isLeftEdgePointOf:isLeftEdgePointOf,isRightEdgePointOf:isRightEdgePointOf,prevPoint:dom_prevPoint,nextPoint:dom_nextPoint,nextPointWithEmptyNode:nextPointWithEmptyNode,isSamePoint:isSamePoint,isVisiblePoint:isVisiblePoint,prevPointUntil:prevPointUntil,nextPointUntil:nextPointUntil,isCharPoint:isCharPoint,isSpacePoint:isSpacePoint,walkPoint:walkPoint,ancestor:dom_ancestor,singleChildAncestor:singleChildAncestor,listAncestor:listAncestor,lastAncestor:lastAncestor,listNext:listNext,listPrev:listPrev,listDescendant:listDescendant,commonAncestor:dom_commonAncestor,wrap:wrap,insertAfter:insertAfter,appendChildNodes:appendChildNodes,position:dom_position,hasChildren:hasChildren,makeOffsetPath:makeOffsetPath,fromOffsetPath:fromOffsetPath,splitTree:splitTree,splitPoint:splitPoint,create:dom_create,createText:createText,remove:remove,removeWhile:removeWhile,replace:dom_replace,html:dom_html,value:dom_value,posFromPlaceholder:posFromPlaceholder,attachEvents:attachEvents,detachEvents:detachEvents,isCustomStyleTag:isCustomStyleTag};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}var Context_Context=function(){function Context($note,options){_classCallCheck(this,Context),this.$note=$note,this.memos={},this.modules={},this.layoutInfo={},this.options=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.extend(!0,{},options),external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui_template(this.options),this.ui=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui,this.initialize()}return _createClass(Context,[{key:"initialize",value:function initialize(){return this.layoutInfo=this.ui.createLayout(this.$note),this._initialize(),this.$note.hide(),this}},{key:"destroy",value:function destroy(){this._destroy(),this.$note.removeData("summernote"),this.ui.removeLayout(this.$note,this.layoutInfo)}},{key:"reset",value:function reset(){var disabled=this.isDisabled();this.code(dom.emptyPara),this._destroy(),this._initialize(),disabled&&this.disable()}},{key:"_initialize",value:function _initialize(){var _this=this;this.options.id=func.uniqueId(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.now()),this.options.container=this.options.container||this.layoutInfo.editor;var buttons=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.extend({},this.options.buttons);Object.keys(buttons).forEach((function(key){_this.memo("button."+key,buttons[key])}));var modules=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.extend({},this.options.modules,external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.plugins||{});Object.keys(modules).forEach((function(key){_this.module(key,modules[key],!0)})),Object.keys(this.modules).forEach((function(key){_this.initializeModule(key)}))}},{key:"_destroy",value:function _destroy(){var _this2=this;Object.keys(this.modules).reverse().forEach((function(key){_this2.removeModule(key)})),Object.keys(this.memos).forEach((function(key){_this2.removeMemo(key)})),this.triggerEvent("destroy",this)}},{key:"code",value:function code(html){var isActivated=this.invoke("codeview.isActivated");if(void 0===html)return this.invoke("codeview.sync"),isActivated?this.layoutInfo.codable.val():this.layoutInfo.editable.html();isActivated?this.invoke("codeview.sync",html):this.layoutInfo.editable.html(html),this.$note.val(html),this.triggerEvent("change",html,this.layoutInfo.editable)}},{key:"isDisabled",value:function isDisabled(){return"false"===this.layoutInfo.editable.attr("contenteditable")}},{key:"enable",value:function enable(){this.layoutInfo.editable.attr("contenteditable",!0),this.invoke("toolbar.activate",!0),this.triggerEvent("disable",!1),this.options.editing=!0}},{key:"disable",value:function disable(){this.invoke("codeview.isActivated")&&this.invoke("codeview.deactivate"),this.layoutInfo.editable.attr("contenteditable",!1),this.options.editing=!1,this.invoke("toolbar.deactivate",!0),this.triggerEvent("disable",!0)}},{key:"triggerEvent",value:function triggerEvent(){var namespace=lists.head(arguments),args=lists.tail(lists.from(arguments)),callback=this.options.callbacks[func.namespaceToCamel(namespace,"on")];callback&&callback.apply(this.$note[0],args),this.$note.trigger("summernote."+namespace,args)}},{key:"initializeModule",value:function initializeModule(key){var module=this.modules[key];module.shouldInitialize=module.shouldInitialize||func.ok,module.shouldInitialize()&&(module.initialize&&module.initialize(),module.events&&dom.attachEvents(this.$note,module.events))}},{key:"module",value:function module(key,ModuleClass,withoutIntialize){if(1===arguments.length)return this.modules[key];this.modules[key]=new ModuleClass(this),withoutIntialize||this.initializeModule(key)}},{key:"removeModule",value:function removeModule(key){var module=this.modules[key];module.shouldInitialize()&&(module.events&&dom.detachEvents(this.$note,module.events),module.destroy&&module.destroy()),delete this.modules[key]}},{key:"memo",value:function memo(key,obj){if(1===arguments.length)return this.memos[key];this.memos[key]=obj}},{key:"removeMemo",value:function removeMemo(key){this.memos[key]&&this.memos[key].destroy&&this.memos[key].destroy(),delete this.memos[key]}},{key:"createInvokeHandlerAndUpdateState",value:function createInvokeHandlerAndUpdateState(namespace,value){var _this3=this;return function(event){_this3.createInvokeHandler(namespace,value)(event),_this3.invoke("buttons.updateCurrentStyle")}}},{key:"createInvokeHandler",value:function createInvokeHandler(namespace,value){var _this4=this;return function(event){event.preventDefault();var $target=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(event.target);_this4.invoke(namespace,value||$target.closest("[data-value]").data("value"),$target)}}},{key:"invoke",value:function invoke(){var namespace=lists.head(arguments),args=lists.tail(lists.from(arguments)),splits=namespace.split("."),hasSeparator=splits.length>1,moduleName=hasSeparator&&lists.head(splits),methodName=hasSeparator?lists.last(splits):lists.head(splits),module=this.modules[moduleName||"editor"];return!moduleName&&this[methodName]?this[methodName].apply(this,args):module&&module[methodName]&&module.shouldInitialize()?module[methodName].apply(module,args):void 0}}]),Context}();function range_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function range_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function range_createClass(Constructor,protoProps,staticProps){return protoProps&&range_defineProperties(Constructor.prototype,protoProps),staticProps&&range_defineProperties(Constructor,staticProps),Constructor}function textRangeToPoint(textRange,isStart){var container=textRange.parentElement(),offset,tester=document.body.createTextRange(),prevContainer,childNodes=lists.from(container.childNodes);for(offset=0;offset<childNodes.length;offset++)if(!dom.isText(childNodes[offset])){if(tester.moveToElementText(childNodes[offset]),tester.compareEndPoints("StartToStart",textRange)>=0)break;prevContainer=childNodes[offset]}if(0!==offset&&dom.isText(childNodes[offset-1])){var textRangeStart=document.body.createTextRange(),curTextNode=null;textRangeStart.moveToElementText(prevContainer||container),textRangeStart.collapse(!prevContainer),curTextNode=prevContainer?prevContainer.nextSibling:container.firstChild;var pointTester=textRange.duplicate();pointTester.setEndPoint("StartToStart",textRangeStart);for(var textCount=pointTester.text.replace(/[\r\n]/g,"").length;textCount>curTextNode.nodeValue.length&&curTextNode.nextSibling;)textCount-=curTextNode.nodeValue.length,curTextNode=curTextNode.nextSibling;var dummy=curTextNode.nodeValue;isStart&&curTextNode.nextSibling&&dom.isText(curTextNode.nextSibling)&&textCount===curTextNode.nodeValue.length&&(textCount-=curTextNode.nodeValue.length,curTextNode=curTextNode.nextSibling),container=curTextNode,offset=textCount}return{cont:container,offset:offset}}function pointToTextRange(point){var textRangeInfo=function textRangeInfo(container,offset){var node,isCollapseToStart;if(dom.isText(container)){var prevTextNodes=dom.listPrev(container,func.not(dom.isText)),prevContainer=lists.last(prevTextNodes).previousSibling;node=prevContainer||container.parentNode,offset+=lists.sum(lists.tail(prevTextNodes),dom.nodeLength),isCollapseToStart=!prevContainer}else{if(node=container.childNodes[offset]||container,dom.isText(node))return textRangeInfo(node,0);offset=0,isCollapseToStart=!1}return{node:node,collapseToStart:isCollapseToStart,offset:offset}},textRange=document.body.createTextRange(),info=textRangeInfo(point.node,point.offset);return textRange.moveToElementText(info.node),textRange.collapse(info.collapseToStart),textRange.moveStart("character",info.offset),textRange}external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.fn.extend({summernote:function summernote(){var type=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.type(lists.head(arguments)),isExternalAPICalled="string"===type,hasInitOptions="object"===type,options=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.extend({},external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.options,hasInitOptions?lists.head(arguments):{});options.langInfo=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.extend(!0,{},external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.lang["en-US"],external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.lang[options.lang]),options.icons=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.extend(!0,{},external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.options.icons,options.icons),options.tooltip="auto"===options.tooltip?!env.isSupportTouch:options.tooltip,this.each((function(idx,note){var $note=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(note);if(!$note.data("summernote")){var context=new Context_Context($note,options);$note.data("summernote",context),$note.data("summernote").triggerEvent("init",context.layoutInfo)}}));var $note=this.first();if($note.length){var context=$note.data("summernote");if(isExternalAPICalled)return context.invoke.apply(context,lists.from(arguments));options.focus&&context.invoke("editor.focus")}return this}});var range_WrappedRange=function(){function WrappedRange(sc,so,ec,eo){range_classCallCheck(this,WrappedRange),this.sc=sc,this.so=so,this.ec=ec,this.eo=eo,this.isOnEditable=this.makeIsOn(dom.isEditable),this.isOnList=this.makeIsOn(dom.isList),this.isOnAnchor=this.makeIsOn(dom.isAnchor),this.isOnCell=this.makeIsOn(dom.isCell),this.isOnData=this.makeIsOn(dom.isData)}return range_createClass(WrappedRange,[{key:"nativeRange",value:function nativeRange(){if(env.isW3CRangeSupport){var w3cRange=document.createRange();return w3cRange.setStart(this.sc,this.so),w3cRange.setEnd(this.ec,this.eo),w3cRange}var textRange=pointToTextRange({node:this.sc,offset:this.so});return textRange.setEndPoint("EndToEnd",pointToTextRange({node:this.ec,offset:this.eo})),textRange}},{key:"getPoints",value:function getPoints(){return{sc:this.sc,so:this.so,ec:this.ec,eo:this.eo}}},{key:"getStartPoint",value:function getStartPoint(){return{node:this.sc,offset:this.so}}},{key:"getEndPoint",value:function getEndPoint(){return{node:this.ec,offset:this.eo}}},{key:"select",value:function select(){var nativeRng=this.nativeRange();if(env.isW3CRangeSupport){var selection=document.getSelection();selection.rangeCount>0&&selection.removeAllRanges(),selection.addRange(nativeRng)}else nativeRng.select();return this}},{key:"scrollIntoView",value:function scrollIntoView(container){var height=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(container).height();return container.scrollTop+height<this.sc.offsetTop&&(container.scrollTop+=Math.abs(container.scrollTop+height-this.sc.offsetTop)),this}},{key:"normalize",value:function normalize(){var getVisiblePoint=function getVisiblePoint(point,isLeftToRight){if(!point)return point;if(dom.isVisiblePoint(point)&&(!dom.isEdgePoint(point)||dom.isRightEdgePoint(point)&&!isLeftToRight||dom.isLeftEdgePoint(point)&&isLeftToRight||dom.isRightEdgePoint(point)&&isLeftToRight&&dom.isVoid(point.node.nextSibling)||dom.isLeftEdgePoint(point)&&!isLeftToRight&&dom.isVoid(point.node.previousSibling)||dom.isBlock(point.node)&&dom.isEmpty(point.node)))return point;var block=dom.ancestor(point.node,dom.isBlock),hasRightNode=!1;if(!hasRightNode){var prevPoint=dom.prevPoint(point)||{node:null};hasRightNode=(dom.isLeftEdgePointOf(point,block)||dom.isVoid(prevPoint.node))&&!isLeftToRight}var hasLeftNode=!1,nextPoint;if(!hasLeftNode){var _nextPoint=dom.nextPoint(point)||{node:null};hasLeftNode=(dom.isRightEdgePointOf(point,block)||dom.isVoid(_nextPoint.node))&&isLeftToRight}if(hasRightNode||hasLeftNode){if(dom.isVisiblePoint(point))return point;isLeftToRight=!isLeftToRight}return(isLeftToRight?dom.nextPointUntil(dom.nextPoint(point),dom.isVisiblePoint):dom.prevPointUntil(dom.prevPoint(point),dom.isVisiblePoint))||point},endPoint=getVisiblePoint(this.getEndPoint(),!1),startPoint=this.isCollapsed()?endPoint:getVisiblePoint(this.getStartPoint(),!0);return new WrappedRange(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset)}},{key:"nodes",value:function nodes(pred,options){pred=pred||func.ok;var includeAncestor=options&&options.includeAncestor,fullyContains=options&&options.fullyContains,startPoint=this.getStartPoint(),endPoint=this.getEndPoint(),nodes=[],leftEdgeNodes=[];return dom.walkPoint(startPoint,endPoint,(function(point){var node;dom.isEditable(point.node)||(fullyContains?(dom.isLeftEdgePoint(point)&&leftEdgeNodes.push(point.node),dom.isRightEdgePoint(point)&&lists.contains(leftEdgeNodes,point.node)&&(node=point.node)):node=includeAncestor?dom.ancestor(point.node,pred):point.node,node&&pred(node)&&nodes.push(node))}),!0),lists.unique(nodes)}},{key:"commonAncestor",value:function commonAncestor(){return dom.commonAncestor(this.sc,this.ec)}},{key:"expand",value:function expand(pred){var startAncestor=dom.ancestor(this.sc,pred),endAncestor=dom.ancestor(this.ec,pred);if(!startAncestor&&!endAncestor)return new WrappedRange(this.sc,this.so,this.ec,this.eo);var boundaryPoints=this.getPoints();return startAncestor&&(boundaryPoints.sc=startAncestor,boundaryPoints.so=0),endAncestor&&(boundaryPoints.ec=endAncestor,boundaryPoints.eo=dom.nodeLength(endAncestor)),new WrappedRange(boundaryPoints.sc,boundaryPoints.so,boundaryPoints.ec,boundaryPoints.eo)}},{key:"collapse",value:function collapse(isCollapseToStart){return isCollapseToStart?new WrappedRange(this.sc,this.so,this.sc,this.so):new WrappedRange(this.ec,this.eo,this.ec,this.eo)}},{key:"splitText",value:function splitText(){var isSameContainer=this.sc===this.ec,boundaryPoints=this.getPoints();return dom.isText(this.ec)&&!dom.isEdgePoint(this.getEndPoint())&&this.ec.splitText(this.eo),dom.isText(this.sc)&&!dom.isEdgePoint(this.getStartPoint())&&(boundaryPoints.sc=this.sc.splitText(this.so),boundaryPoints.so=0,isSameContainer&&(boundaryPoints.ec=boundaryPoints.sc,boundaryPoints.eo=this.eo-this.so)),new WrappedRange(boundaryPoints.sc,boundaryPoints.so,boundaryPoints.ec,boundaryPoints.eo)}},{key:"deleteContents",value:function deleteContents(){if(this.isCollapsed())return this;var rng=this.splitText(),nodes=rng.nodes(null,{fullyContains:!0}),point=dom.prevPointUntil(rng.getStartPoint(),(function(point){return!lists.contains(nodes,point.node)})),emptyParents=[];return external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(nodes,(function(idx,node){var parent=node.parentNode;point.node!==parent&&1===dom.nodeLength(parent)&&emptyParents.push(parent),dom.remove(node,!1)})),external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(emptyParents,(function(idx,node){dom.remove(node,!1)})),new WrappedRange(point.node,point.offset,point.node,point.offset).normalize()}},{key:"makeIsOn",value:function makeIsOn(pred){return function(){var ancestor=dom.ancestor(this.sc,pred);return!!ancestor&&ancestor===dom.ancestor(this.ec,pred)}}},{key:"isLeftEdgeOf",value:function isLeftEdgeOf(pred){if(!dom.isLeftEdgePoint(this.getStartPoint()))return!1;var node=dom.ancestor(this.sc,pred);return node&&dom.isLeftEdgeOf(this.sc,node)}},{key:"isCollapsed",value:function isCollapsed(){return this.sc===this.ec&&this.so===this.eo}},{key:"wrapBodyInlineWithPara",value:function wrapBodyInlineWithPara(){if(dom.isBodyContainer(this.sc)&&dom.isEmpty(this.sc))return this.sc.innerHTML=dom.emptyPara,new WrappedRange(this.sc.firstChild,0,this.sc.firstChild,0);var rng=this.normalize(),topAncestor;if(dom.isParaInline(this.sc)||dom.isPara(this.sc))return rng;if(dom.isInline(rng.sc)){var ancestors=dom.listAncestor(rng.sc,func.not(dom.isInline));topAncestor=lists.last(ancestors),dom.isInline(topAncestor)||(topAncestor=ancestors[ancestors.length-2]||rng.sc.childNodes[rng.so])}else topAncestor=rng.sc.childNodes[rng.so>0?rng.so-1:0];if(topAncestor){var inlineSiblings=dom.listPrev(topAncestor,dom.isParaInline).reverse();if((inlineSiblings=inlineSiblings.concat(dom.listNext(topAncestor.nextSibling,dom.isParaInline))).length){var para=dom.wrap(lists.head(inlineSiblings),"p");dom.appendChildNodes(para,lists.tail(inlineSiblings))}}return this.normalize()}},{key:"insertNode",value:function insertNode(node){var rng=this;(dom.isText(node)||dom.isInline(node))&&(rng=this.wrapBodyInlineWithPara().deleteContents());var info=dom.splitPoint(rng.getStartPoint(),dom.isInline(node));return info.rightNode?(info.rightNode.parentNode.insertBefore(node,info.rightNode),dom.isEmpty(info.rightNode)&&dom.isPara(node)&&info.rightNode.parentNode.removeChild(info.rightNode)):info.container.appendChild(node),node}},{key:"pasteHTML",value:function pasteHTML(markup){markup=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.trim(markup);var contentsContainer=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<div></div>").html(markup)[0],childNodes=lists.from(contentsContainer.childNodes),rng=this,reversed=!1;return rng.so>=0&&(childNodes=childNodes.reverse(),reversed=!0),childNodes=childNodes.map((function(childNode){return rng.insertNode(childNode)})),reversed&&(childNodes=childNodes.reverse()),childNodes}},{key:"toString",value:function toString(){var nativeRng=this.nativeRange();return env.isW3CRangeSupport?nativeRng.toString():nativeRng.text}},{key:"getWordRange",value:function getWordRange(findAfter){var endPoint=this.getEndPoint();if(!dom.isCharPoint(endPoint))return this;var startPoint=dom.prevPointUntil(endPoint,(function(point){return!dom.isCharPoint(point)}));return findAfter&&(endPoint=dom.nextPointUntil(endPoint,(function(point){return!dom.isCharPoint(point)}))),new WrappedRange(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset)}},{key:"getWordsRange",value:function getWordsRange(findAfter){var endPoint=this.getEndPoint(),isNotTextPoint=function isNotTextPoint(point){return!dom.isCharPoint(point)&&!dom.isSpacePoint(point)};if(isNotTextPoint(endPoint))return this;var startPoint=dom.prevPointUntil(endPoint,isNotTextPoint);return findAfter&&(endPoint=dom.nextPointUntil(endPoint,isNotTextPoint)),new WrappedRange(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset)}},{key:"getWordsMatchRange",value:function getWordsMatchRange(regex){var endPoint=this.getEndPoint(),startPoint=dom.prevPointUntil(endPoint,(function(point){if(!dom.isCharPoint(point)&&!dom.isSpacePoint(point))return!0;var rng=new WrappedRange(point.node,point.offset,endPoint.node,endPoint.offset),result=regex.exec(rng.toString());return result&&0===result.index})),rng=new WrappedRange(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset),text=rng.toString(),result=regex.exec(text);return result&&result[0].length===text.length?rng:null}},{key:"bookmark",value:function bookmark(editable){return{s:{path:dom.makeOffsetPath(editable,this.sc),offset:this.so},e:{path:dom.makeOffsetPath(editable,this.ec),offset:this.eo}}}},{key:"paraBookmark",value:function paraBookmark(paras){return{s:{path:lists.tail(dom.makeOffsetPath(lists.head(paras),this.sc)),offset:this.so},e:{path:lists.tail(dom.makeOffsetPath(lists.last(paras),this.ec)),offset:this.eo}}}},{key:"getClientRects",value:function getClientRects(){var nativeRng;return this.nativeRange().getClientRects()}}]),WrappedRange}(),range={create:function create(sc,so,ec,eo){if(4===arguments.length)return new range_WrappedRange(sc,so,ec,eo);if(2===arguments.length)return new range_WrappedRange(sc,so,ec=sc,eo=so);var wrappedRange=this.createFromSelection();if(!wrappedRange&&1===arguments.length){var bodyElement=arguments[0];return dom.isEditable(bodyElement)&&(bodyElement=bodyElement.lastChild),this.createFromBodyElement(bodyElement,dom.emptyPara===arguments[0].innerHTML)}return wrappedRange},createFromBodyElement:function createFromBodyElement(bodyElement){var isCollapseToStart=arguments.length>1&&void 0!==arguments[1]&&arguments[1],wrappedRange=this.createFromNode(bodyElement);return wrappedRange.collapse(isCollapseToStart)},createFromSelection:function createFromSelection(){var sc,so,ec,eo;if(env.isW3CRangeSupport){var selection=document.getSelection();if(!selection||0===selection.rangeCount)return null;if(dom.isBody(selection.anchorNode))return null;var nativeRng=selection.getRangeAt(0);sc=nativeRng.startContainer,so=nativeRng.startOffset,ec=nativeRng.endContainer,eo=nativeRng.endOffset}else{var textRange=document.selection.createRange(),textRangeEnd=textRange.duplicate();textRangeEnd.collapse(!1);var textRangeStart=textRange;textRangeStart.collapse(!0);var startPoint=textRangeToPoint(textRangeStart,!0),endPoint=textRangeToPoint(textRangeEnd,!1);dom.isText(startPoint.node)&&dom.isLeftEdgePoint(startPoint)&&dom.isTextNode(endPoint.node)&&dom.isRightEdgePoint(endPoint)&&endPoint.node.nextSibling===startPoint.node&&(startPoint=endPoint),sc=startPoint.cont,so=startPoint.offset,ec=endPoint.cont,eo=endPoint.offset}return new range_WrappedRange(sc,so,ec,eo)},createFromNode:function createFromNode(node){var sc=node,so=0,ec=node,eo=dom.nodeLength(ec);return dom.isVoid(sc)&&(so=dom.listPrev(sc).length-1,sc=sc.parentNode),dom.isBR(ec)?(eo=dom.listPrev(ec).length-1,ec=ec.parentNode):dom.isVoid(ec)&&(eo=dom.listPrev(ec).length,ec=ec.parentNode),this.create(sc,so,ec,eo)},createFromNodeBefore:function createFromNodeBefore(node){return this.createFromNode(node).collapse(!0)},createFromNodeAfter:function createFromNodeAfter(node){return this.createFromNode(node).collapse()},createFromBookmark:function createFromBookmark(editable,bookmark){var sc=dom.fromOffsetPath(editable,bookmark.s.path),so=bookmark.s.offset,ec=dom.fromOffsetPath(editable,bookmark.e.path),eo=bookmark.e.offset;return new range_WrappedRange(sc,so,ec,eo)},createFromParaBookmark:function createFromParaBookmark(bookmark,paras){var so=bookmark.s.offset,eo=bookmark.e.offset,sc=dom.fromOffsetPath(lists.head(paras),bookmark.s.path),ec=dom.fromOffsetPath(lists.last(paras),bookmark.e.path);return new range_WrappedRange(sc,so,ec,eo)}},KEY_MAP={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,DELETE:46,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,V:86,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLASH:220,RIGHTBRACKET:221,HOME:36,END:35,PAGEUP:33,PAGEDOWN:34},core_key={isEdit:function isEdit(keyCode){return lists.contains([KEY_MAP.BACKSPACE,KEY_MAP.TAB,KEY_MAP.ENTER,KEY_MAP.SPACE,KEY_MAP.DELETE],keyCode)},isMove:function isMove(keyCode){return lists.contains([KEY_MAP.LEFT,KEY_MAP.UP,KEY_MAP.RIGHT,KEY_MAP.DOWN],keyCode)},isNavigation:function isNavigation(keyCode){return lists.contains([KEY_MAP.HOME,KEY_MAP.END,KEY_MAP.PAGEUP,KEY_MAP.PAGEDOWN],keyCode)},nameFromCode:func.invertObject(KEY_MAP),code:KEY_MAP};function readFileAsDataURL(file){return external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.Deferred((function(deferred){external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.extend(new FileReader,{onload:function onload(e){var dataURL=e.target.result;deferred.resolve(dataURL)},onerror:function onerror(err){deferred.reject(err)}}).readAsDataURL(file)})).promise()}function createImage(url){return external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.Deferred((function(deferred){var $img=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<img>");$img.one("load",(function(){$img.off("error abort"),deferred.resolve($img)})).one("error abort",(function(){$img.off("load").detach(),deferred.reject($img)})).css({display:"none"}).appendTo(document.body).attr("src",url)})).promise()}function History_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function History_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function History_createClass(Constructor,protoProps,staticProps){return protoProps&&History_defineProperties(Constructor.prototype,protoProps),staticProps&&History_defineProperties(Constructor,staticProps),Constructor}var History_History=function(){function History(context){History_classCallCheck(this,History),this.stack=[],this.stackOffset=-1,this.context=context,this.$editable=context.layoutInfo.editable,this.editable=this.$editable[0]}return History_createClass(History,[{key:"makeSnapshot",value:function makeSnapshot(){var rng=range.create(this.editable),emptyBookmark={s:{path:[],offset:0},e:{path:[],offset:0}};return{contents:this.$editable.html(),bookmark:rng&&rng.isOnEditable()?rng.bookmark(this.editable):emptyBookmark}}},{key:"applySnapshot",value:function applySnapshot(snapshot){null!==snapshot.contents&&this.$editable.html(snapshot.contents),null!==snapshot.bookmark&&range.createFromBookmark(this.editable,snapshot.bookmark).select()}},{key:"rewind",value:function rewind(){this.$editable.html()!==this.stack[this.stackOffset].contents&&this.recordUndo(),this.stackOffset=0,this.applySnapshot(this.stack[this.stackOffset])}},{key:"commit",value:function commit(){this.stack=[],this.stackOffset=-1,this.recordUndo()}},{key:"reset",value:function reset(){this.stack=[],this.stackOffset=-1,this.$editable.html(""),this.recordUndo()}},{key:"undo",value:function undo(){this.$editable.html()!==this.stack[this.stackOffset].contents&&this.recordUndo(),this.stackOffset>0&&(this.stackOffset--,this.applySnapshot(this.stack[this.stackOffset]))}},{key:"redo",value:function redo(){this.stack.length-1>this.stackOffset&&(this.stackOffset++,this.applySnapshot(this.stack[this.stackOffset]))}},{key:"recordUndo",value:function recordUndo(){this.stackOffset++,this.stack.length>this.stackOffset&&(this.stack=this.stack.slice(0,this.stackOffset)),this.stack.push(this.makeSnapshot()),this.stack.length>this.context.options.historyLimit&&(this.stack.shift(),this.stackOffset-=1)}}]),History}();function Style_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Style_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Style_createClass(Constructor,protoProps,staticProps){return protoProps&&Style_defineProperties(Constructor.prototype,protoProps),staticProps&&Style_defineProperties(Constructor,staticProps),Constructor}var Style_Style=function(){function Style(){Style_classCallCheck(this,Style)}return Style_createClass(Style,[{key:"jQueryCSS",value:function jQueryCSS($obj,propertyNames){if(env.jqueryVersion<1.9){var result={};return external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(propertyNames,(function(idx,propertyName){result[propertyName]=$obj.css(propertyName)})),result}return $obj.css(propertyNames)}},{key:"fromNode",value:function fromNode($node){var properties=["font-family","font-size","text-align","list-style-type","line-height"],styleInfo=this.jQueryCSS($node,properties)||{},fontSize=$node[0].style.fontSize||styleInfo["font-size"];return styleInfo["font-size"]=parseInt(fontSize,10),styleInfo["font-size-unit"]=fontSize.match(/[a-z%]+$/),styleInfo}},{key:"stylePara",value:function stylePara(rng,styleInfo){external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(rng.nodes(dom.isPara,{includeAncestor:!0}),(function(idx,para){external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(para).css(styleInfo)}))}},{key:"styleNodes",value:function styleNodes(rng,options){rng=rng.splitText();var nodeName=options&&options.nodeName||"SPAN",expandClosestSibling=!(!options||!options.expandClosestSibling),onlyPartialContains=!(!options||!options.onlyPartialContains);if(rng.isCollapsed())return[rng.insertNode(dom.create(nodeName))];var pred=dom.makePredByNodeName(nodeName),nodes=rng.nodes(dom.isText,{fullyContains:!0}).map((function(text){return dom.singleChildAncestor(text,pred)||dom.wrap(text,nodeName)}));if(expandClosestSibling){if(onlyPartialContains){var nodesInRange=rng.nodes();pred=func.and(pred,(function(node){return lists.contains(nodesInRange,node)}))}return nodes.map((function(node){var siblings=dom.withClosestSiblings(node,pred),head=lists.head(siblings),tails=lists.tail(siblings);return external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(tails,(function(idx,elem){dom.appendChildNodes(head,elem.childNodes),dom.remove(elem)})),lists.head(siblings)}))}return nodes}},{key:"current",value:function current(rng){var $cont=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(dom.isElement(rng.sc)?rng.sc:rng.sc.parentNode),styleInfo=this.fromNode($cont);try{styleInfo=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.extend(styleInfo,{"font-bold":document.queryCommandState("bold")?"bold":"normal","font-italic":document.queryCommandState("italic")?"italic":"normal","font-underline":document.queryCommandState("underline")?"underline":"normal","font-subscript":document.queryCommandState("subscript")?"subscript":"normal","font-superscript":document.queryCommandState("superscript")?"superscript":"normal","font-strikethrough":document.queryCommandState("strikethrough")?"strikethrough":"normal","font-family":document.queryCommandValue("fontname")||styleInfo["font-family"]})}catch(e){}if(rng.isOnList()){var orderedTypes,isUnordered=["circle","disc","disc-leading-zero","square"].indexOf(styleInfo["list-style-type"])>-1;styleInfo["list-style"]=isUnordered?"unordered":"ordered"}else styleInfo["list-style"]="none";var para=dom.ancestor(rng.sc,dom.isPara);if(para&&para.style["line-height"])styleInfo["line-height"]=para.style.lineHeight;else{var lineHeight=parseInt(styleInfo["line-height"],10)/parseInt(styleInfo["font-size"],10);styleInfo["line-height"]=lineHeight.toFixed(1)}return styleInfo.anchor=rng.isOnAnchor()&&dom.ancestor(rng.sc,dom.isAnchor),styleInfo.ancestors=dom.listAncestor(rng.sc,dom.isEditable),styleInfo.range=rng,styleInfo}}]),Style}();function Bullet_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Bullet_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Bullet_createClass(Constructor,protoProps,staticProps){return protoProps&&Bullet_defineProperties(Constructor.prototype,protoProps),staticProps&&Bullet_defineProperties(Constructor,staticProps),Constructor}var Bullet_Bullet=function(){function Bullet(){Bullet_classCallCheck(this,Bullet)}return Bullet_createClass(Bullet,[{key:"insertOrderedList",value:function insertOrderedList(editable){this.toggleList("OL",editable)}},{key:"insertUnorderedList",value:function insertUnorderedList(editable){this.toggleList("UL",editable)}},{key:"indent",value:function indent(editable){var _this=this,rng=range.create(editable).wrapBodyInlineWithPara(),paras=rng.nodes(dom.isPara,{includeAncestor:!0}),clustereds=lists.clusterBy(paras,func.peq2("parentNode"));external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(clustereds,(function(idx,paras){var head=lists.head(paras);if(dom.isLi(head)){var previousList=_this.findList(head.previousSibling);previousList?paras.map((function(para){return previousList.appendChild(para)})):(_this.wrapList(paras,head.parentNode.nodeName),paras.map((function(para){return para.parentNode})).map((function(para){return _this.appendToPrevious(para)})))}else external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(paras,(function(idx,para){external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(para).css("marginLeft",(function(idx,val){return(parseInt(val,10)||0)+25}))}))})),rng.select()}},{key:"outdent",value:function outdent(editable){var _this2=this,rng=range.create(editable).wrapBodyInlineWithPara(),paras=rng.nodes(dom.isPara,{includeAncestor:!0}),clustereds=lists.clusterBy(paras,func.peq2("parentNode"));external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(clustereds,(function(idx,paras){var head=lists.head(paras);dom.isLi(head)?_this2.releaseList([paras]):external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(paras,(function(idx,para){external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(para).css("marginLeft",(function(idx,val){return(val=parseInt(val,10)||0)>25?val-25:""}))}))})),rng.select()}},{key:"toggleList",value:function toggleList(listName,editable){var _this3=this,rng=range.create(editable).wrapBodyInlineWithPara(),paras=rng.nodes(dom.isPara,{includeAncestor:!0}),bookmark=rng.paraBookmark(paras),clustereds=lists.clusterBy(paras,func.peq2("parentNode"));if(lists.find(paras,dom.isPurePara)){var wrappedParas=[];external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(clustereds,(function(idx,paras){wrappedParas=wrappedParas.concat(_this3.wrapList(paras,listName))})),paras=wrappedParas}else{var diffLists=rng.nodes(dom.isList,{includeAncestor:!0}).filter((function(listNode){return!external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.nodeName(listNode,listName)}));diffLists.length?external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(diffLists,(function(idx,listNode){dom.replace(listNode,listName)})):paras=this.releaseList(clustereds,!0)}range.createFromParaBookmark(bookmark,paras).select()}},{key:"wrapList",value:function wrapList(paras,listName){var head=lists.head(paras),last=lists.last(paras),prevList=dom.isList(head.previousSibling)&&head.previousSibling,nextList=dom.isList(last.nextSibling)&&last.nextSibling,listNode=prevList||dom.insertAfter(dom.create(listName||"UL"),last);return paras=paras.map((function(para){return dom.isPurePara(para)?dom.replace(para,"LI"):para})),dom.appendChildNodes(listNode,paras),nextList&&(dom.appendChildNodes(listNode,lists.from(nextList.childNodes)),dom.remove(nextList)),paras}},{key:"releaseList",value:function releaseList(clustereds,isEscapseToBody){var _this4=this,releasedParas=[];return external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(clustereds,(function(idx,paras){var head=lists.head(paras),last=lists.last(paras),headList=isEscapseToBody?dom.lastAncestor(head,dom.isList):head.parentNode,parentItem=headList.parentNode;if("LI"===headList.parentNode.nodeName)paras.map((function(para){var newList=_this4.findNextSiblings(para);parentItem.nextSibling?parentItem.parentNode.insertBefore(para,parentItem.nextSibling):parentItem.parentNode.appendChild(para),newList.length&&(_this4.wrapList(newList,headList.nodeName),para.appendChild(newList[0].parentNode))})),0===headList.children.length&&parentItem.removeChild(headList),0===parentItem.childNodes.length&&parentItem.parentNode.removeChild(parentItem);else{var lastList=headList.childNodes.length>1?dom.splitTree(headList,{node:last.parentNode,offset:dom.position(last)+1},{isSkipPaddingBlankHTML:!0}):null,middleList=dom.splitTree(headList,{node:head.parentNode,offset:dom.position(head)},{isSkipPaddingBlankHTML:!0});paras=isEscapseToBody?dom.listDescendant(middleList,dom.isLi):lists.from(middleList.childNodes).filter(dom.isLi),!isEscapseToBody&&dom.isList(headList.parentNode)||(paras=paras.map((function(para){return dom.replace(para,"P")}))),external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(lists.from(paras).reverse(),(function(idx,para){dom.insertAfter(para,headList)}));var rootLists=lists.compact([headList,middleList,lastList]);external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(rootLists,(function(idx,rootList){var listNodes=[rootList].concat(dom.listDescendant(rootList,dom.isList));external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(listNodes.reverse(),(function(idx,listNode){dom.nodeLength(listNode)||dom.remove(listNode,!0)}))}))}releasedParas=releasedParas.concat(paras)})),releasedParas}},{key:"appendToPrevious",value:function appendToPrevious(node){return node.previousSibling?dom.appendChildNodes(node.previousSibling,[node]):this.wrapList([node],"LI")}},{key:"findList",value:function findList(node){return node?lists.find(node.children,(function(child){return["OL","UL"].indexOf(child.nodeName)>-1})):null}},{key:"findNextSiblings",value:function findNextSiblings(node){for(var siblings=[];node.nextSibling;)siblings.push(node.nextSibling),node=node.nextSibling;return siblings}}]),Bullet}();function Typing_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Typing_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Typing_createClass(Constructor,protoProps,staticProps){return protoProps&&Typing_defineProperties(Constructor.prototype,protoProps),staticProps&&Typing_defineProperties(Constructor,staticProps),Constructor}var Typing_Typing=function(){function Typing(context){Typing_classCallCheck(this,Typing),this.bullet=new Bullet_Bullet,this.options=context.options}return Typing_createClass(Typing,[{key:"insertTab",value:function insertTab(rng,tabsize){var tab=dom.createText(new Array(tabsize+1).join(dom.NBSP_CHAR));(rng=rng.deleteContents()).insertNode(tab,!0),(rng=range.create(tab,tabsize)).select()}},{key:"insertParagraph",value:function insertParagraph(editable,rng){rng=(rng=(rng=rng||range.create(editable)).deleteContents()).wrapBodyInlineWithPara();var splitRoot=dom.ancestor(rng.sc,dom.isPara),nextPara;if(splitRoot){if(dom.isLi(splitRoot)&&(dom.isEmpty(splitRoot)||dom.deepestChildIsEmpty(splitRoot)))return void this.bullet.toggleList(splitRoot.parentNode.nodeName);var blockquote=null;if(1===this.options.blockquoteBreakingLevel?blockquote=dom.ancestor(splitRoot,dom.isBlockquote):2===this.options.blockquoteBreakingLevel&&(blockquote=dom.lastAncestor(splitRoot,dom.isBlockquote)),blockquote){nextPara=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(dom.emptyPara)[0],dom.isRightEdgePoint(rng.getStartPoint())&&dom.isBR(rng.sc.nextSibling)&&external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(rng.sc.nextSibling).remove();var split=dom.splitTree(blockquote,rng.getStartPoint(),{isDiscardEmptySplits:!0});split?split.parentNode.insertBefore(nextPara,split):dom.insertAfter(nextPara,blockquote)}else{nextPara=dom.splitTree(splitRoot,rng.getStartPoint());var emptyAnchors=dom.listDescendant(splitRoot,dom.isEmptyAnchor);emptyAnchors=emptyAnchors.concat(dom.listDescendant(nextPara,dom.isEmptyAnchor)),external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(emptyAnchors,(function(idx,anchor){dom.remove(anchor)})),(dom.isHeading(nextPara)||dom.isPre(nextPara)||dom.isCustomStyleTag(nextPara))&&dom.isEmpty(nextPara)&&(nextPara=dom.replace(nextPara,"p"))}}else{var next=rng.sc.childNodes[rng.so];nextPara=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(dom.emptyPara)[0],next?rng.sc.insertBefore(nextPara,next):rng.sc.appendChild(nextPara)}range.create(nextPara,0).normalize().select().scrollIntoView(editable)}}]),Typing}();function Table_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Table_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Table_createClass(Constructor,protoProps,staticProps){return protoProps&&Table_defineProperties(Constructor.prototype,protoProps),staticProps&&Table_defineProperties(Constructor,staticProps),Constructor}var TableResultAction=function TableResultAction(startPoint,where,action,domTable){var _startPoint={colPos:0,rowPos:0},_virtualTable=[],_actionCellList=[];function setStartPoint(){startPoint&&startPoint.tagName&&("td"===startPoint.tagName.toLowerCase()||"th"===startPoint.tagName.toLowerCase())&&(_startPoint.colPos=startPoint.cellIndex,startPoint.parentElement&&startPoint.parentElement.tagName&&"tr"===startPoint.parentElement.tagName.toLowerCase()&&(_startPoint.rowPos=startPoint.parentElement.rowIndex))}function setVirtualTablePosition(rowIndex,cellIndex,baseRow,baseCell,isRowSpan,isColSpan,isVirtualCell){var objPosition={baseRow:baseRow,baseCell:baseCell,isRowSpan:isRowSpan,isColSpan:isColSpan,isVirtual:isVirtualCell};_virtualTable[rowIndex]||(_virtualTable[rowIndex]=[]),_virtualTable[rowIndex][cellIndex]=objPosition}function getActionCell(virtualTableCellObj,resultAction,virtualRowPosition,virtualColPosition){return{baseCell:virtualTableCellObj.baseCell,action:resultAction,virtualTable:{rowIndex:virtualRowPosition,cellIndex:virtualColPosition}}}function recoverCellIndex(rowIndex,cellIndex){if(!_virtualTable[rowIndex])return cellIndex;if(!_virtualTable[rowIndex][cellIndex])return cellIndex;for(var newCellIndex=cellIndex;_virtualTable[rowIndex][newCellIndex];)if(newCellIndex++,!_virtualTable[rowIndex][newCellIndex])return newCellIndex}function addCellInfoToVirtual(row,cell){var cellIndex=recoverCellIndex(row.rowIndex,cell.cellIndex),cellHasColspan=cell.colSpan>1,cellHasRowspan=cell.rowSpan>1,isThisSelectedCell=row.rowIndex===_startPoint.rowPos&&cell.cellIndex===_startPoint.colPos;setVirtualTablePosition(row.rowIndex,cellIndex,row,cell,cellHasRowspan,cellHasColspan,!1);var rowspanNumber=cell.attributes.rowSpan?parseInt(cell.attributes.rowSpan.value,10):0;if(rowspanNumber>1)for(var rp=1;rp<rowspanNumber;rp++){var rowspanIndex=row.rowIndex+rp;adjustStartPoint(rowspanIndex,cellIndex,cell,isThisSelectedCell),setVirtualTablePosition(rowspanIndex,cellIndex,row,cell,!0,cellHasColspan,!0)}var colspanNumber=cell.attributes.colSpan?parseInt(cell.attributes.colSpan.value,10):0;if(colspanNumber>1)for(var cp=1;cp<colspanNumber;cp++){var cellspanIndex=recoverCellIndex(row.rowIndex,cellIndex+cp);adjustStartPoint(row.rowIndex,cellspanIndex,cell,isThisSelectedCell),setVirtualTablePosition(row.rowIndex,cellspanIndex,row,cell,cellHasRowspan,!0,!0)}}function adjustStartPoint(rowIndex,cellIndex,cell,isSelectedCell){rowIndex===_startPoint.rowPos&&_startPoint.colPos>=cell.cellIndex&&cell.cellIndex<=cellIndex&&!isSelectedCell&&_startPoint.colPos++}function createVirtualTable(){for(var rows=domTable.rows,rowIndex=0;rowIndex<rows.length;rowIndex++)for(var cells=rows[rowIndex].cells,cellIndex=0;cellIndex<cells.length;cellIndex++)addCellInfoToVirtual(rows[rowIndex],cells[cellIndex])}function getDeleteResultActionToCell(cell){switch(where){case TableResultAction.where.Column:if(cell.isColSpan)return TableResultAction.resultAction.SubtractSpanCount;break;case TableResultAction.where.Row:if(!cell.isVirtual&&cell.isRowSpan)return TableResultAction.resultAction.AddCell;if(cell.isRowSpan)return TableResultAction.resultAction.SubtractSpanCount}return TableResultAction.resultAction.RemoveCell}function getAddResultActionToCell(cell){switch(where){case TableResultAction.where.Column:if(cell.isColSpan)return TableResultAction.resultAction.SumSpanCount;if(cell.isRowSpan&&cell.isVirtual)return TableResultAction.resultAction.Ignore;break;case TableResultAction.where.Row:if(cell.isRowSpan)return TableResultAction.resultAction.SumSpanCount;if(cell.isColSpan&&cell.isVirtual)return TableResultAction.resultAction.Ignore}return TableResultAction.resultAction.AddCell}function init(){setStartPoint(),createVirtualTable()}this.getActionList=function(){for(var fixedRow=where===TableResultAction.where.Row?_startPoint.rowPos:-1,fixedCol=where===TableResultAction.where.Column?_startPoint.colPos:-1,actualPosition=0,canContinue=!0;canContinue;){var rowPosition=fixedRow>=0?fixedRow:actualPosition,colPosition=fixedCol>=0?fixedCol:actualPosition,row=_virtualTable[rowPosition];if(!row)return canContinue=!1,_actionCellList;var cell=row[colPosition];if(!cell)return canContinue=!1,_actionCellList;var resultAction=TableResultAction.resultAction.Ignore;switch(action){case TableResultAction.requestAction.Add:resultAction=getAddResultActionToCell(cell);break;case TableResultAction.requestAction.Delete:resultAction=getDeleteResultActionToCell(cell)}_actionCellList.push(getActionCell(cell,resultAction,rowPosition,colPosition)),actualPosition++}return _actionCellList},init()};TableResultAction.where={Row:0,Column:1},TableResultAction.requestAction={Add:0,Delete:1},TableResultAction.resultAction={Ignore:0,SubtractSpanCount:1,RemoveCell:2,AddCell:3,SumSpanCount:4};var Table_Table=function(){function Table(){Table_classCallCheck(this,Table)}return Table_createClass(Table,[{key:"tab",value:function tab(rng,isShift){var cell=dom.ancestor(rng.commonAncestor(),dom.isCell),table=dom.ancestor(cell,dom.isTable),cells=dom.listDescendant(table,dom.isCell),nextCell=lists[isShift?"prev":"next"](cells,cell);nextCell&&range.create(nextCell,0).select()}},{key:"addRow",value:function addRow(rng,position){for(var cell=dom.ancestor(rng.commonAncestor(),dom.isCell),currentTr=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(cell).closest("tr"),trAttributes=this.recoverAttributes(currentTr),html=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<tr"+trAttributes+"></tr>"),vTable,actions=new TableResultAction(cell,TableResultAction.where.Row,TableResultAction.requestAction.Add,external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(currentTr).closest("table")[0]).getActionList(),idCell=0;idCell<actions.length;idCell++){var currentCell=actions[idCell],tdAttributes=this.recoverAttributes(currentCell.baseCell);switch(currentCell.action){case TableResultAction.resultAction.AddCell:html.append("<td"+tdAttributes+">"+dom.blank+"</td>");break;case TableResultAction.resultAction.SumSpanCount:var baseCellTr,isTopFromRowSpan;if("top"===position)if((currentCell.baseCell.parent?currentCell.baseCell.closest("tr").rowIndex:0)<=currentTr[0].rowIndex){var newTd=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<div></div>").append(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<td"+tdAttributes+">"+dom.blank+"</td>").removeAttr("rowspan")).html();html.append(newTd);break}var rowspanNumber=parseInt(currentCell.baseCell.rowSpan,10);rowspanNumber++,currentCell.baseCell.setAttribute("rowSpan",rowspanNumber)}}if("top"===position)currentTr.before(html);else{var cellHasRowspan;if(cell.rowSpan>1){var lastTrIndex=currentTr[0].rowIndex+(cell.rowSpan-2);return void external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(currentTr).parent().find("tr")[lastTrIndex]).after(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(html))}currentTr.after(html)}}},{key:"addCol",value:function addCol(rng,position){var cell=dom.ancestor(rng.commonAncestor(),dom.isCell),row=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(cell).closest("tr"),rowsGroup;external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(row).siblings().push(row);for(var vTable,actions=new TableResultAction(cell,TableResultAction.where.Column,TableResultAction.requestAction.Add,external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(row).closest("table")[0]).getActionList(),actionIndex=0;actionIndex<actions.length;actionIndex++){var currentCell=actions[actionIndex],tdAttributes=this.recoverAttributes(currentCell.baseCell);switch(currentCell.action){case TableResultAction.resultAction.AddCell:"right"===position?external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(currentCell.baseCell).after("<td"+tdAttributes+">"+dom.blank+"</td>"):external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(currentCell.baseCell).before("<td"+tdAttributes+">"+dom.blank+"</td>");break;case TableResultAction.resultAction.SumSpanCount:if("right"===position){var colspanNumber=parseInt(currentCell.baseCell.colSpan,10);colspanNumber++,currentCell.baseCell.setAttribute("colSpan",colspanNumber)}else external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(currentCell.baseCell).before("<td"+tdAttributes+">"+dom.blank+"</td>")}}}},{key:"recoverAttributes",value:function recoverAttributes(el){var resultStr="";if(!el)return resultStr;for(var attrList=el.attributes||[],i=0;i<attrList.length;i++)"id"!==attrList[i].name.toLowerCase()&&attrList[i].specified&&(resultStr+=" "+attrList[i].name+"='"+attrList[i].value+"'");return resultStr}},{key:"deleteRow",value:function deleteRow(rng){for(var cell=dom.ancestor(rng.commonAncestor(),dom.isCell),row=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(cell).closest("tr"),cellPos=row.children("td, th").index(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(cell)),rowPos=row[0].rowIndex,vTable,actions=new TableResultAction(cell,TableResultAction.where.Row,TableResultAction.requestAction.Delete,external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(row).closest("table")[0]).getActionList(),actionIndex=0;actionIndex<actions.length;actionIndex++)if(actions[actionIndex]){var baseCell=actions[actionIndex].baseCell,virtualPosition=actions[actionIndex].virtualTable,hasRowspan=baseCell.rowSpan&&baseCell.rowSpan>1,rowspanNumber=hasRowspan?parseInt(baseCell.rowSpan,10):0;switch(actions[actionIndex].action){case TableResultAction.resultAction.Ignore:continue;case TableResultAction.resultAction.AddCell:var nextRow=row.next("tr")[0];if(!nextRow)continue;var cloneRow=row[0].cells[cellPos];hasRowspan&&(rowspanNumber>2?(rowspanNumber--,nextRow.insertBefore(cloneRow,nextRow.cells[cellPos]),nextRow.cells[cellPos].setAttribute("rowSpan",rowspanNumber),nextRow.cells[cellPos].innerHTML=""):2===rowspanNumber&&(nextRow.insertBefore(cloneRow,nextRow.cells[cellPos]),nextRow.cells[cellPos].removeAttribute("rowSpan"),nextRow.cells[cellPos].innerHTML=""));continue;case TableResultAction.resultAction.SubtractSpanCount:hasRowspan&&(rowspanNumber>2?(rowspanNumber--,baseCell.setAttribute("rowSpan",rowspanNumber),virtualPosition.rowIndex!==rowPos&&baseCell.cellIndex===cellPos&&(baseCell.innerHTML="")):2===rowspanNumber&&(baseCell.removeAttribute("rowSpan"),virtualPosition.rowIndex!==rowPos&&baseCell.cellIndex===cellPos&&(baseCell.innerHTML="")));continue;case TableResultAction.resultAction.RemoveCell:continue}}row.remove()}},{key:"deleteCol",value:function deleteCol(rng){for(var cell=dom.ancestor(rng.commonAncestor(),dom.isCell),row=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(cell).closest("tr"),cellPos=row.children("td, th").index(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(cell)),vTable,actions=new TableResultAction(cell,TableResultAction.where.Column,TableResultAction.requestAction.Delete,external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(row).closest("table")[0]).getActionList(),actionIndex=0;actionIndex<actions.length;actionIndex++)if(actions[actionIndex])switch(actions[actionIndex].action){case TableResultAction.resultAction.Ignore:continue;case TableResultAction.resultAction.SubtractSpanCount:var baseCell=actions[actionIndex].baseCell,hasColspan;if(baseCell.colSpan&&baseCell.colSpan>1){var colspanNumber=baseCell.colSpan?parseInt(baseCell.colSpan,10):0;colspanNumber>2?(colspanNumber--,baseCell.setAttribute("colSpan",colspanNumber),baseCell.cellIndex===cellPos&&(baseCell.innerHTML="")):2===colspanNumber&&(baseCell.removeAttribute("colSpan"),baseCell.cellIndex===cellPos&&(baseCell.innerHTML=""))}continue;case TableResultAction.resultAction.RemoveCell:dom.remove(actions[actionIndex].baseCell,!0);continue}}},{key:"createTable",value:function createTable(colCount,rowCount,options){for(var tds=[],tdHTML,idxCol=0;idxCol<colCount;idxCol++)tds.push("<td>"+dom.blank+"</td>");tdHTML=tds.join("");for(var trs=[],trHTML,idxRow=0;idxRow<rowCount;idxRow++)trs.push("<tr>"+tdHTML+"</tr>");trHTML=trs.join("");var $table=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<table>"+trHTML+"</table>");return options&&options.tableClassName&&$table.addClass(options.tableClassName),$table[0]}},{key:"deleteTable",value:function deleteTable(rng){var cell=dom.ancestor(rng.commonAncestor(),dom.isCell);external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(cell).closest("table").remove()}}]),Table}();function Editor_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Editor_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Editor_createClass(Constructor,protoProps,staticProps){return protoProps&&Editor_defineProperties(Constructor.prototype,protoProps),staticProps&&Editor_defineProperties(Constructor,staticProps),Constructor}var KEY_BOGUS="bogus",Editor_Editor=function(){function Editor(context){var _this=this;Editor_classCallCheck(this,Editor),this.context=context,this.$note=context.layoutInfo.note,this.$editor=context.layoutInfo.editor,this.$editable=context.layoutInfo.editable,this.options=context.options,this.lang=this.options.langInfo,this.editable=this.$editable[0],this.lastRange=null,this.snapshot=null,this.style=new Style_Style,this.table=new Table_Table,this.typing=new Typing_Typing(context),this.bullet=new Bullet_Bullet,this.history=new History_History(context),this.context.memo("help.escape",this.lang.help.escape),this.context.memo("help.undo",this.lang.help.undo),this.context.memo("help.redo",this.lang.help.redo),this.context.memo("help.tab",this.lang.help.tab),this.context.memo("help.untab",this.lang.help.untab),this.context.memo("help.insertParagraph",this.lang.help.insertParagraph),this.context.memo("help.insertOrderedList",this.lang.help.insertOrderedList),this.context.memo("help.insertUnorderedList",this.lang.help.insertUnorderedList),this.context.memo("help.indent",this.lang.help.indent),this.context.memo("help.outdent",this.lang.help.outdent),this.context.memo("help.formatPara",this.lang.help.formatPara),this.context.memo("help.insertHorizontalRule",this.lang.help.insertHorizontalRule),this.context.memo("help.fontName",this.lang.help.fontName);for(var commands=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor"],idx=0,len=commands.length;idx<len;idx++)this[commands[idx]]=function(sCmd){return function(value){_this.beforeCommand(),document.execCommand(sCmd,!1,value),_this.afterCommand(!0)}}(commands[idx]),this.context.memo("help."+commands[idx],this.lang.help[commands[idx]]);this.fontName=this.wrapCommand((function(value){return _this.fontStyling("font-family",env.validFontName(value))})),this.fontSize=this.wrapCommand((function(value){var unit=_this.currentStyle()["font-size-unit"];return _this.fontStyling("font-size",value+unit)})),this.fontSizeUnit=this.wrapCommand((function(value){var size=_this.currentStyle()["font-size"];return _this.fontStyling("font-size",size+value)}));for(var _idx=1;_idx<=6;_idx++)this["formatH"+_idx]=function(idx){return function(){_this.formatBlock("H"+idx)}}(_idx),this.context.memo("help.formatH"+_idx,this.lang.help["formatH"+_idx]);this.insertParagraph=this.wrapCommand((function(){_this.typing.insertParagraph(_this.editable)})),this.insertOrderedList=this.wrapCommand((function(){_this.bullet.insertOrderedList(_this.editable)})),this.insertUnorderedList=this.wrapCommand((function(){_this.bullet.insertUnorderedList(_this.editable)})),this.indent=this.wrapCommand((function(){_this.bullet.indent(_this.editable)})),this.outdent=this.wrapCommand((function(){_this.bullet.outdent(_this.editable)})),this.insertNode=this.wrapCommand((function(node){var rng;_this.isLimited(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(node).text().length)||(_this.getLastRange().insertNode(node),_this.setLastRange(range.createFromNodeAfter(node).select()))})),this.insertText=this.wrapCommand((function(text){if(!_this.isLimited(text.length)){var rng,textNode=_this.getLastRange().insertNode(dom.createText(text));_this.setLastRange(range.create(textNode,dom.nodeLength(textNode)).select())}})),this.pasteHTML=this.wrapCommand((function(markup){if(!_this.isLimited(markup.length)){markup=_this.context.invoke("codeview.purify",markup);var contents=_this.getLastRange().pasteHTML(markup);_this.setLastRange(range.createFromNodeAfter(lists.last(contents)).select())}})),this.formatBlock=this.wrapCommand((function(tagName,$target){var onApplyCustomStyle=_this.options.callbacks.onApplyCustomStyle;onApplyCustomStyle?onApplyCustomStyle.call(_this,$target,_this.context,_this.onFormatBlock):_this.onFormatBlock(tagName,$target)})),this.insertHorizontalRule=this.wrapCommand((function(){var hrNode=_this.getLastRange().insertNode(dom.create("HR"));hrNode.nextSibling&&_this.setLastRange(range.create(hrNode.nextSibling,0).normalize().select())})),this.lineHeight=this.wrapCommand((function(value){_this.style.stylePara(_this.getLastRange(),{lineHeight:value})})),this.createLink=this.wrapCommand((function(linkInfo){var linkUrl=linkInfo.url,linkText=linkInfo.text,isNewWindow=linkInfo.isNewWindow,checkProtocol=linkInfo.checkProtocol,rng=linkInfo.range||_this.getLastRange(),additionalTextLength=linkText.length-rng.toString().length;if(!(additionalTextLength>0&&_this.isLimited(additionalTextLength))){var isTextChanged=rng.toString()!==linkText;"string"==typeof linkUrl&&(linkUrl=linkUrl.trim()),_this.options.onCreateLink?linkUrl=_this.options.onCreateLink(linkUrl):checkProtocol&&(linkUrl=/^([A-Za-z][A-Za-z0-9+-.]*\:|#|\/)/.test(linkUrl)?linkUrl:_this.options.defaultProtocol+linkUrl);var anchors=[];if(isTextChanged){var anchor=(rng=rng.deleteContents()).insertNode(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<A>"+linkText+"</A>")[0]);anchors.push(anchor)}else anchors=_this.style.styleNodes(rng,{nodeName:"A",expandClosestSibling:!0,onlyPartialContains:!0});external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(anchors,(function(idx,anchor){external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(anchor).attr("href",linkUrl),isNewWindow?external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(anchor).attr("target","_blank"):external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(anchor).removeAttr("target")})),_this.setLastRange(_this.createRangeFromList(anchors).select())}})),this.color=this.wrapCommand((function(colorInfo){var foreColor=colorInfo.foreColor,backColor=colorInfo.backColor;foreColor&&document.execCommand("foreColor",!1,foreColor),backColor&&document.execCommand("backColor",!1,backColor)})),this.foreColor=this.wrapCommand((function(colorInfo){document.execCommand("foreColor",!1,colorInfo)})),this.insertTable=this.wrapCommand((function(dim){var dimension=dim.split("x"),rng;_this.getLastRange().deleteContents().insertNode(_this.table.createTable(dimension[0],dimension[1],_this.options))})),this.removeMedia=this.wrapCommand((function(){var $target=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(_this.restoreTarget()).parent();$target.closest("figure").length?$target.closest("figure").remove():$target=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(_this.restoreTarget()).detach(),_this.context.triggerEvent("media.delete",$target,_this.$editable)})),this.floatMe=this.wrapCommand((function(value){var $target=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(_this.restoreTarget());$target.toggleClass("note-float-left","left"===value),$target.toggleClass("note-float-right","right"===value),$target.css("float","none"===value?"":value)})),this.resize=this.wrapCommand((function(value){var $target=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(_this.restoreTarget());0===(value=parseFloat(value))?$target.css("width",""):$target.css({width:100*value+"%",height:""})}))}return Editor_createClass(Editor,[{key:"initialize",value:function initialize(){var _this2=this;this.$editable.on("keydown",(function(event){if(event.keyCode===core_key.code.ENTER&&_this2.context.triggerEvent("enter",event),_this2.context.triggerEvent("keydown",event),_this2.snapshot=_this2.history.makeSnapshot(),_this2.hasKeyShortCut=!1,event.isDefaultPrevented()||(_this2.options.shortcuts?_this2.hasKeyShortCut=_this2.handleKeyMap(event):_this2.preventDefaultEditableShortCuts(event)),_this2.isLimited(1,event)){var lastRange=_this2.getLastRange();if(lastRange.eo-lastRange.so==0)return!1}_this2.setLastRange(),_this2.options.recordEveryKeystroke&&!1===_this2.hasKeyShortCut&&_this2.history.recordUndo()})).on("keyup",(function(event){_this2.setLastRange(),_this2.context.triggerEvent("keyup",event)})).on("focus",(function(event){_this2.setLastRange(),_this2.context.triggerEvent("focus",event)})).on("blur",(function(event){_this2.context.triggerEvent("blur",event)})).on("mousedown",(function(event){_this2.context.triggerEvent("mousedown",event)})).on("mouseup",(function(event){_this2.setLastRange(),_this2.history.recordUndo(),_this2.context.triggerEvent("mouseup",event)})).on("scroll",(function(event){_this2.context.triggerEvent("scroll",event)})).on("paste",(function(event){_this2.setLastRange(),_this2.context.triggerEvent("paste",event)})).on("input",(function(){_this2.isLimited(0)&&_this2.snapshot&&_this2.history.applySnapshot(_this2.snapshot)})),this.$editable.attr("spellcheck",this.options.spellCheck),this.$editable.attr("autocorrect",this.options.spellCheck),this.options.disableGrammar&&this.$editable.attr("data-gramm",!1),this.$editable.html(dom.html(this.$note)||dom.emptyPara),this.$editable.on(env.inputEventName,func.debounce((function(){_this2.context.triggerEvent("change",_this2.$editable.html(),_this2.$editable)}),10)),this.$editable.on("focusin",(function(event){_this2.context.triggerEvent("focusin",event)})).on("focusout",(function(event){_this2.context.triggerEvent("focusout",event)})),this.options.airMode?this.options.overrideContextMenu&&this.$editor.on("contextmenu",(function(event){return _this2.context.triggerEvent("contextmenu",event),!1})):(this.options.width&&this.$editor.outerWidth(this.options.width),this.options.height&&this.$editable.outerHeight(this.options.height),this.options.maxHeight&&this.$editable.css("max-height",this.options.maxHeight),this.options.minHeight&&this.$editable.css("min-height",this.options.minHeight)),this.history.recordUndo(),this.setLastRange()}},{key:"destroy",value:function destroy(){this.$editable.off()}},{key:"handleKeyMap",value:function handleKeyMap(event){var keyMap=this.options.keyMap[env.isMac?"mac":"pc"],keys=[];event.metaKey&&keys.push("CMD"),event.ctrlKey&&!event.altKey&&keys.push("CTRL"),event.shiftKey&&keys.push("SHIFT");var keyName=core_key.nameFromCode[event.keyCode];keyName&&keys.push(keyName);var eventName=keyMap[keys.join("+")];if("TAB"!==keyName||this.options.tabDisable)if(eventName){if(!1!==this.context.invoke(eventName))return event.preventDefault(),!0}else core_key.isEdit(event.keyCode)&&this.afterCommand();else this.afterCommand();return!1}},{key:"preventDefaultEditableShortCuts",value:function preventDefaultEditableShortCuts(event){(event.ctrlKey||event.metaKey)&&lists.contains([66,73,85],event.keyCode)&&event.preventDefault()}},{key:"isLimited",value:function isLimited(pad,event){return pad=pad||0,(void 0===event||!(core_key.isMove(event.keyCode)||core_key.isNavigation(event.keyCode)||event.ctrlKey||event.metaKey||lists.contains([core_key.code.BACKSPACE,core_key.code.DELETE],event.keyCode)))&&(this.options.maxTextLength>0&&this.$editable.text().length+pad>this.options.maxTextLength)}},{key:"createRange",value:function createRange(){return this.focus(),this.setLastRange(),this.getLastRange()}},{key:"createRangeFromList",value:function createRangeFromList(lst){var startRange,startPoint=range.createFromNodeBefore(lists.head(lst)).getStartPoint(),endRange,endPoint=range.createFromNodeAfter(lists.last(lst)).getEndPoint();return range.create(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset)}},{key:"setLastRange",value:function setLastRange(rng){rng?this.lastRange=rng:(this.lastRange=range.create(this.editable),0===external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(this.lastRange.sc).closest(".note-editable").length&&(this.lastRange=range.createFromBodyElement(this.editable)))}},{key:"getLastRange",value:function getLastRange(){return this.lastRange||this.setLastRange(),this.lastRange}},{key:"saveRange",value:function saveRange(thenCollapse){thenCollapse&&this.getLastRange().collapse().select()}},{key:"restoreRange",value:function restoreRange(){this.lastRange&&(this.lastRange.select(),this.focus())}},{key:"saveTarget",value:function saveTarget(node){this.$editable.data("target",node)}},{key:"clearTarget",value:function clearTarget(){this.$editable.removeData("target")}},{key:"restoreTarget",value:function restoreTarget(){return this.$editable.data("target")}},{key:"currentStyle",value:function currentStyle(){var rng=range.create();return rng&&(rng=rng.normalize()),rng?this.style.current(rng):this.style.fromNode(this.$editable)}},{key:"styleFromNode",value:function styleFromNode($node){return this.style.fromNode($node)}},{key:"undo",value:function undo(){this.context.triggerEvent("before.command",this.$editable.html()),this.history.undo(),this.context.triggerEvent("change",this.$editable.html(),this.$editable)}},{key:"commit",value:function commit(){this.context.triggerEvent("before.command",this.$editable.html()),this.history.commit(),this.context.triggerEvent("change",this.$editable.html(),this.$editable)}},{key:"redo",value:function redo(){this.context.triggerEvent("before.command",this.$editable.html()),this.history.redo(),this.context.triggerEvent("change",this.$editable.html(),this.$editable)}},{key:"beforeCommand",value:function beforeCommand(){this.context.triggerEvent("before.command",this.$editable.html()),document.execCommand("styleWithCSS",!1,this.options.styleWithCSS),this.focus()}},{key:"afterCommand",value:function afterCommand(isPreventTrigger){this.normalizeContent(),this.history.recordUndo(),isPreventTrigger||this.context.triggerEvent("change",this.$editable.html(),this.$editable)}},{key:"tab",value:function tab(){var rng=this.getLastRange();if(rng.isCollapsed()&&rng.isOnCell())this.table.tab(rng);else{if(0===this.options.tabSize)return!1;this.isLimited(this.options.tabSize)||(this.beforeCommand(),this.typing.insertTab(rng,this.options.tabSize),this.afterCommand())}}},{key:"untab",value:function untab(){var rng=this.getLastRange();if(rng.isCollapsed()&&rng.isOnCell())this.table.tab(rng,!0);else if(0===this.options.tabSize)return!1}},{key:"wrapCommand",value:function wrapCommand(fn){return function(){this.beforeCommand(),fn.apply(this,arguments),this.afterCommand()}}},{key:"insertImage",value:function insertImage(src,param){var _this3=this;return createImage(src,param).then((function($image){_this3.beforeCommand(),"function"==typeof param?param($image):("string"==typeof param&&$image.attr("data-filename",param),$image.css("width",Math.min(_this3.$editable.width(),$image.width()))),$image.show(),_this3.getLastRange().insertNode($image[0]),_this3.setLastRange(range.createFromNodeAfter($image[0]).select()),_this3.afterCommand()})).fail((function(e){_this3.context.triggerEvent("image.upload.error",e)}))}},{key:"insertImagesAsDataURL",value:function insertImagesAsDataURL(files){var _this4=this;external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(files,(function(idx,file){var filename=file.name;_this4.options.maximumImageFileSize&&_this4.options.maximumImageFileSize<file.size?_this4.context.triggerEvent("image.upload.error",_this4.lang.image.maximumFileSizeError):readFileAsDataURL(file).then((function(dataURL){return _this4.insertImage(dataURL,filename)})).fail((function(){_this4.context.triggerEvent("image.upload.error")}))}))}},{key:"insertImagesOrCallback",value:function insertImagesOrCallback(files){var callbacks;this.options.callbacks.onImageUpload?this.context.triggerEvent("image.upload",files):this.insertImagesAsDataURL(files)}},{key:"getSelectedText",value:function getSelectedText(){var rng=this.getLastRange();return rng.isOnAnchor()&&(rng=range.createFromNode(dom.ancestor(rng.sc,dom.isAnchor))),rng.toString()}},{key:"onFormatBlock",value:function onFormatBlock(tagName,$target){if(document.execCommand("FormatBlock",!1,env.isMSIE?"<"+tagName+">":tagName),$target&&$target.length&&($target[0].tagName.toUpperCase()!==tagName.toUpperCase()&&($target=$target.find(tagName)),$target&&$target.length)){var className=$target[0].className||"";if(className){var currentRange=this.createRange(),$parent;external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()([currentRange.sc,currentRange.ec]).closest(tagName).addClass(className)}}}},{key:"formatPara",value:function formatPara(){this.formatBlock("P")}},{key:"fontStyling",value:function fontStyling(target,value){var rng=this.getLastRange();if(""!==rng){var spans=this.style.styleNodes(rng);if(this.$editor.find(".note-status-output").html(""),external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(spans).css(target,value),rng.isCollapsed()){var firstSpan=lists.head(spans);firstSpan&&!dom.nodeLength(firstSpan)&&(firstSpan.innerHTML=dom.ZERO_WIDTH_NBSP_CHAR,range.createFromNode(firstSpan.firstChild).select(),this.setLastRange(),this.$editable.data("bogus",firstSpan))}else this.setLastRange(this.createRangeFromList(spans).select())}else{var noteStatusOutput=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.now();this.$editor.find(".note-status-output").html('<div id="note-status-output-'+noteStatusOutput+'" class="alert alert-info">'+this.lang.output.noSelection+"</div>"),setTimeout((function(){external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("#note-status-output-"+noteStatusOutput).remove()}),5e3)}}},{key:"unlink",value:function unlink(){var rng=this.getLastRange();if(rng.isOnAnchor()){var anchor=dom.ancestor(rng.sc,dom.isAnchor);(rng=range.createFromNode(anchor)).select(),this.setLastRange(),this.beforeCommand(),document.execCommand("unlink"),this.afterCommand()}}},{key:"getLinkInfo",value:function getLinkInfo(){var rng=this.getLastRange().expand(dom.isAnchor),$anchor=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(lists.head(rng.nodes(dom.isAnchor))),linkInfo={range:rng,text:rng.toString(),url:$anchor.length?$anchor.attr("href"):""};return $anchor.length&&(linkInfo.isNewWindow="_blank"===$anchor.attr("target")),linkInfo}},{key:"addRow",value:function addRow(position){var rng=this.getLastRange(this.$editable);rng.isCollapsed()&&rng.isOnCell()&&(this.beforeCommand(),this.table.addRow(rng,position),this.afterCommand())}},{key:"addCol",value:function addCol(position){var rng=this.getLastRange(this.$editable);rng.isCollapsed()&&rng.isOnCell()&&(this.beforeCommand(),this.table.addCol(rng,position),this.afterCommand())}},{key:"deleteRow",value:function deleteRow(){var rng=this.getLastRange(this.$editable);rng.isCollapsed()&&rng.isOnCell()&&(this.beforeCommand(),this.table.deleteRow(rng),this.afterCommand())}},{key:"deleteCol",value:function deleteCol(){var rng=this.getLastRange(this.$editable);rng.isCollapsed()&&rng.isOnCell()&&(this.beforeCommand(),this.table.deleteCol(rng),this.afterCommand())}},{key:"deleteTable",value:function deleteTable(){var rng=this.getLastRange(this.$editable);rng.isCollapsed()&&rng.isOnCell()&&(this.beforeCommand(),this.table.deleteTable(rng),this.afterCommand())}},{key:"resizeTo",value:function resizeTo(pos,$target,bKeepRatio){var imageSize;if(bKeepRatio){var newRatio=pos.y/pos.x,ratio=$target.data("ratio");imageSize={width:ratio>newRatio?pos.x:pos.y/ratio,height:ratio>newRatio?pos.x*ratio:pos.y}}else imageSize={width:pos.x,height:pos.y};$target.css(imageSize)}},{key:"hasFocus",value:function hasFocus(){return this.$editable.is(":focus")}},{key:"focus",value:function focus(){this.hasFocus()||this.$editable.focus()}},{key:"isEmpty",value:function isEmpty(){return dom.isEmpty(this.$editable[0])||dom.emptyPara===this.$editable.html()}},{key:"empty",value:function empty(){this.context.invoke("code",dom.emptyPara)}},{key:"normalizeContent",value:function normalizeContent(){this.$editable[0].normalize()}}]),Editor}();function Clipboard_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Clipboard_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Clipboard_createClass(Constructor,protoProps,staticProps){return protoProps&&Clipboard_defineProperties(Constructor.prototype,protoProps),staticProps&&Clipboard_defineProperties(Constructor,staticProps),Constructor}var Clipboard_Clipboard=function(){function Clipboard(context){Clipboard_classCallCheck(this,Clipboard),this.context=context,this.$editable=context.layoutInfo.editable}return Clipboard_createClass(Clipboard,[{key:"initialize",value:function initialize(){this.$editable.on("paste",this.pasteByEvent.bind(this))}},{key:"pasteByEvent",value:function pasteByEvent(event){var _this=this,clipboardData=event.originalEvent.clipboardData;if(clipboardData&&clipboardData.items&&clipboardData.items.length){var item=clipboardData.items.length>1?clipboardData.items[1]:lists.head(clipboardData.items);"file"===item.kind&&-1!==item.type.indexOf("image/")?(this.context.invoke("editor.insertImagesOrCallback",[item.getAsFile()]),event.preventDefault()):"string"===item.kind&&this.context.invoke("editor.isLimited",clipboardData.getData("Text").length)&&event.preventDefault()}else if(window.clipboardData){var text=window.clipboardData.getData("text");this.context.invoke("editor.isLimited",text.length)&&event.preventDefault()}setTimeout((function(){_this.context.invoke("editor.afterCommand")}),10)}}]),Clipboard}();function Dropzone_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Dropzone_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Dropzone_createClass(Constructor,protoProps,staticProps){return protoProps&&Dropzone_defineProperties(Constructor.prototype,protoProps),staticProps&&Dropzone_defineProperties(Constructor,staticProps),Constructor}var Dropzone_Dropzone=function(){function Dropzone(context){Dropzone_classCallCheck(this,Dropzone),this.context=context,this.$eventListener=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(document),this.$editor=context.layoutInfo.editor,this.$editable=context.layoutInfo.editable,this.options=context.options,this.lang=this.options.langInfo,this.documentEventHandlers={},this.$dropzone=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(['<div class="note-dropzone">','<div class="note-dropzone-message"></div>',"</div>"].join("")).prependTo(this.$editor)}return Dropzone_createClass(Dropzone,[{key:"initialize",value:function initialize(){this.options.disableDragAndDrop?(this.documentEventHandlers.onDrop=function(e){e.preventDefault()},this.$eventListener=this.$dropzone,this.$eventListener.on("drop",this.documentEventHandlers.onDrop)):this.attachDragAndDropEvent()}},{key:"attachDragAndDropEvent",value:function attachDragAndDropEvent(){var _this=this,collection=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(),$dropzoneMessage=this.$dropzone.find(".note-dropzone-message");this.documentEventHandlers.onDragenter=function(e){var isCodeview=_this.context.invoke("codeview.isActivated"),hasEditorSize=_this.$editor.width()>0&&_this.$editor.height()>0;isCodeview||collection.length||!hasEditorSize||(_this.$editor.addClass("dragover"),_this.$dropzone.width(_this.$editor.width()),_this.$dropzone.height(_this.$editor.height()),$dropzoneMessage.text(_this.lang.image.dragImageHere)),collection=collection.add(e.target)},this.documentEventHandlers.onDragleave=function(e){(collection=collection.not(e.target)).length&&"BODY"!==e.target.nodeName||(collection=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(),_this.$editor.removeClass("dragover"))},this.documentEventHandlers.onDrop=function(){collection=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(),_this.$editor.removeClass("dragover")},this.$eventListener.on("dragenter",this.documentEventHandlers.onDragenter).on("dragleave",this.documentEventHandlers.onDragleave).on("drop",this.documentEventHandlers.onDrop),this.$dropzone.on("dragenter",(function(){_this.$dropzone.addClass("hover"),$dropzoneMessage.text(_this.lang.image.dropImage)})).on("dragleave",(function(){_this.$dropzone.removeClass("hover"),$dropzoneMessage.text(_this.lang.image.dragImageHere)})),this.$dropzone.on("drop",(function(event){var dataTransfer=event.originalEvent.dataTransfer;event.preventDefault(),dataTransfer&&dataTransfer.files&&dataTransfer.files.length?(_this.$editable.focus(),_this.context.invoke("editor.insertImagesOrCallback",dataTransfer.files)):external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(dataTransfer.types,(function(idx,type){if(!(type.toLowerCase().indexOf("_moz_")>-1)){var content=dataTransfer.getData(type);type.toLowerCase().indexOf("text")>-1?_this.context.invoke("editor.pasteHTML",content):external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(content).each((function(idx,item){_this.context.invoke("editor.insertNode",item)}))}}))})).on("dragover",!1)}},{key:"destroy",value:function destroy(){var _this2=this;Object.keys(this.documentEventHandlers).forEach((function(key){_this2.$eventListener.off(key.substr(2).toLowerCase(),_this2.documentEventHandlers[key])})),this.documentEventHandlers={}}}]),Dropzone}();function _createForOfIteratorHelper(o){if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(o=_unsupportedIterableToArray(o))){var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var it,normalCompletion=!0,didErr=!1,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Codeview_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Codeview_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Codeview_createClass(Constructor,protoProps,staticProps){return protoProps&&Codeview_defineProperties(Constructor.prototype,protoProps),staticProps&&Codeview_defineProperties(Constructor,staticProps),Constructor}var Codeview_CodeView=function(){function CodeView(context){Codeview_classCallCheck(this,CodeView),this.context=context,this.$editor=context.layoutInfo.editor,this.$editable=context.layoutInfo.editable,this.$codable=context.layoutInfo.codable,this.options=context.options,this.CodeMirrorConstructor=window.CodeMirror,this.options.codemirror.CodeMirrorConstructor&&(this.CodeMirrorConstructor=this.options.codemirror.CodeMirrorConstructor)}return Codeview_createClass(CodeView,[{key:"sync",value:function sync(html){var isCodeview=this.isActivated(),CodeMirror=this.CodeMirrorConstructor;isCodeview&&(html?CodeMirror?this.$codable.data("cmEditor").getDoc().setValue(html):this.$codable.val(html):CodeMirror&&this.$codable.data("cmEditor").save())}},{key:"initialize",value:function initialize(){var _this=this;this.$codable.on("keyup",(function(event){event.keyCode===core_key.code.ESCAPE&&_this.deactivate()}))}},{key:"isActivated",value:function isActivated(){return this.$editor.hasClass("codeview")}},{key:"toggle",value:function toggle(){this.isActivated()?this.deactivate():this.activate(),this.context.triggerEvent("codeview.toggled")}},{key:"purify",value:function purify(value){if(this.options.codeviewFilter&&(value=value.replace(this.options.codeviewFilterRegex,""),this.options.codeviewIframeFilter)){var whitelist=this.options.codeviewIframeWhitelistSrc.concat(this.options.codeviewIframeWhitelistSrcBase);value=value.replace(/(<iframe.*?>.*?(?:<\/iframe>)?)/gi,(function(tag){if(/<.+src(?==?('|"|\s)?)[\s\S]+src(?=('|"|\s)?)[^>]*?>/i.test(tag))return"";var _iterator=_createForOfIteratorHelper(whitelist),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var src=_step.value;if(new RegExp('src="(https?:)?//'+src.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+'/(.+)"').test(tag))return tag}}catch(err){_iterator.e(err)}finally{_iterator.f()}return""}))}return value}},{key:"activate",value:function activate(){var _this2=this,CodeMirror=this.CodeMirrorConstructor;if(this.$codable.val(dom.html(this.$editable,this.options.prettifyHtml)),this.$codable.height(this.$editable.height()),this.context.invoke("toolbar.updateCodeview",!0),this.context.invoke("airPopover.updateCodeview",!0),this.$editor.addClass("codeview"),this.$codable.focus(),CodeMirror){var cmEditor=CodeMirror.fromTextArea(this.$codable[0],this.options.codemirror);if(this.options.codemirror.tern){var server=new CodeMirror.TernServer(this.options.codemirror.tern);cmEditor.ternServer=server,cmEditor.on("cursorActivity",(function(cm){server.updateArgHints(cm)}))}cmEditor.on("blur",(function(event){_this2.context.triggerEvent("blur.codeview",cmEditor.getValue(),event)})),cmEditor.on("change",(function(){_this2.context.triggerEvent("change.codeview",cmEditor.getValue(),cmEditor)})),cmEditor.setSize(null,this.$editable.outerHeight()),this.$codable.data("cmEditor",cmEditor)}else this.$codable.on("blur",(function(event){_this2.context.triggerEvent("blur.codeview",_this2.$codable.val(),event)})),this.$codable.on("input",(function(){_this2.context.triggerEvent("change.codeview",_this2.$codable.val(),_this2.$codable)}))}},{key:"deactivate",value:function deactivate(){var CodeMirror;if(this.CodeMirrorConstructor){var cmEditor=this.$codable.data("cmEditor");this.$codable.val(cmEditor.getValue()),cmEditor.toTextArea()}var value=this.purify(dom.value(this.$codable,this.options.prettifyHtml)||dom.emptyPara),isChange=this.$editable.html()!==value;this.$editable.html(value),this.$editable.height(this.options.height?this.$codable.height():"auto"),this.$editor.removeClass("codeview"),isChange&&this.context.triggerEvent("change",this.$editable.html(),this.$editable),this.$editable.focus(),this.context.invoke("toolbar.updateCodeview",!1),this.context.invoke("airPopover.updateCodeview",!1)}},{key:"destroy",value:function destroy(){this.isActivated()&&this.deactivate()}}]),CodeView}();function Statusbar_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Statusbar_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Statusbar_createClass(Constructor,protoProps,staticProps){return protoProps&&Statusbar_defineProperties(Constructor.prototype,protoProps),staticProps&&Statusbar_defineProperties(Constructor,staticProps),Constructor}var EDITABLE_PADDING=24,Statusbar_Statusbar=function(){function Statusbar(context){Statusbar_classCallCheck(this,Statusbar),this.$document=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(document),this.$statusbar=context.layoutInfo.statusbar,this.$editable=context.layoutInfo.editable,this.options=context.options}return Statusbar_createClass(Statusbar,[{key:"initialize",value:function initialize(){var _this=this;this.options.airMode||this.options.disableResizeEditor?this.destroy():this.$statusbar.on("mousedown",(function(event){event.preventDefault(),event.stopPropagation();var editableTop=_this.$editable.offset().top-_this.$document.scrollTop(),onMouseMove=function onMouseMove(event){var height=event.clientY-(editableTop+24);height=_this.options.minheight>0?Math.max(height,_this.options.minheight):height,height=_this.options.maxHeight>0?Math.min(height,_this.options.maxHeight):height,_this.$editable.height(height)};_this.$document.on("mousemove",onMouseMove).one("mouseup",(function(){_this.$document.off("mousemove",onMouseMove)}))}))}},{key:"destroy",value:function destroy(){this.$statusbar.off(),this.$statusbar.addClass("locked")}}]),Statusbar}();function Fullscreen_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Fullscreen_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Fullscreen_createClass(Constructor,protoProps,staticProps){return protoProps&&Fullscreen_defineProperties(Constructor.prototype,protoProps),staticProps&&Fullscreen_defineProperties(Constructor,staticProps),Constructor}var Fullscreen_Fullscreen=function(){function Fullscreen(context){var _this=this;Fullscreen_classCallCheck(this,Fullscreen),this.context=context,this.$editor=context.layoutInfo.editor,this.$toolbar=context.layoutInfo.toolbar,this.$editable=context.layoutInfo.editable,this.$codable=context.layoutInfo.codable,this.$window=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(window),this.$scrollbar=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("html, body"),this.onResize=function(){_this.resizeTo({h:_this.$window.height()-_this.$toolbar.outerHeight()})}}return Fullscreen_createClass(Fullscreen,[{key:"resizeTo",value:function resizeTo(size){this.$editable.css("height",size.h),this.$codable.css("height",size.h),this.$codable.data("cmeditor")&&this.$codable.data("cmeditor").setsize(null,size.h)}},{key:"toggle",value:function toggle(){this.$editor.toggleClass("fullscreen"),this.isFullscreen()?(this.$editable.data("orgHeight",this.$editable.css("height")),this.$editable.data("orgMaxHeight",this.$editable.css("maxHeight")),this.$editable.css("maxHeight",""),this.$window.on("resize",this.onResize).trigger("resize"),this.$scrollbar.css("overflow","hidden")):(this.$window.off("resize",this.onResize),this.resizeTo({h:this.$editable.data("orgHeight")}),this.$editable.css("maxHeight",this.$editable.css("orgMaxHeight")),this.$scrollbar.css("overflow","visible")),this.context.invoke("toolbar.updateFullscreen",this.isFullscreen())}},{key:"isFullscreen",value:function isFullscreen(){return this.$editor.hasClass("fullscreen")}}]),Fullscreen}();function Handle_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Handle_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Handle_createClass(Constructor,protoProps,staticProps){return protoProps&&Handle_defineProperties(Constructor.prototype,protoProps),staticProps&&Handle_defineProperties(Constructor,staticProps),Constructor}var Handle_Handle=function(){function Handle(context){var _this=this;Handle_classCallCheck(this,Handle),this.context=context,this.$document=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(document),this.$editingArea=context.layoutInfo.editingArea,this.options=context.options,this.lang=this.options.langInfo,this.events={"summernote.mousedown":function summernoteMousedown(we,e){_this.update(e.target,e)&&e.preventDefault()},"summernote.keyup summernote.scroll summernote.change summernote.dialog.shown":function summernoteKeyupSummernoteScrollSummernoteChangeSummernoteDialogShown(){_this.update()},"summernote.disable summernote.blur":function summernoteDisableSummernoteBlur(){_this.hide()},"summernote.codeview.toggled":function summernoteCodeviewToggled(){_this.update()}}}return Handle_createClass(Handle,[{key:"initialize",value:function initialize(){var _this2=this;this.$handle=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(['<div class="note-handle">','<div class="note-control-selection">','<div class="note-control-selection-bg"></div>','<div class="note-control-holder note-control-nw"></div>','<div class="note-control-holder note-control-ne"></div>','<div class="note-control-holder note-control-sw"></div>','<div class="',this.options.disableResizeImage?"note-control-holder":"note-control-sizing",' note-control-se"></div>',this.options.disableResizeImage?"":'<div class="note-control-selection-info"></div>',"</div>","</div>"].join("")).prependTo(this.$editingArea),this.$handle.on("mousedown",(function(event){if(dom.isControlSizing(event.target)){event.preventDefault(),event.stopPropagation();var $target=_this2.$handle.find(".note-control-selection").data("target"),posStart=$target.offset(),scrollTop=_this2.$document.scrollTop(),onMouseMove=function onMouseMove(event){_this2.context.invoke("editor.resizeTo",{x:event.clientX-posStart.left,y:event.clientY-(posStart.top-scrollTop)},$target,!event.shiftKey),_this2.update($target[0],event)};_this2.$document.on("mousemove",onMouseMove).one("mouseup",(function(e){e.preventDefault(),_this2.$document.off("mousemove",onMouseMove),_this2.context.invoke("editor.afterCommand")})),$target.data("ratio")||$target.data("ratio",$target.height()/$target.width())}})),this.$handle.on("wheel",(function(e){e.preventDefault(),_this2.update()}))}},{key:"destroy",value:function destroy(){this.$handle.remove()}},{key:"update",value:function update(target,event){if(this.context.isDisabled())return!1;var isImage=dom.isImg(target),$selection=this.$handle.find(".note-control-selection");if(this.context.invoke("imagePopover.update",target,event),isImage){var $image=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(target),position=$image.position(),pos={left:position.left+parseInt($image.css("marginLeft"),10),top:position.top+parseInt($image.css("marginTop"),10)},imageSize={w:$image.outerWidth(!1),h:$image.outerHeight(!1)};$selection.css({display:"block",left:pos.left,top:pos.top,width:imageSize.w,height:imageSize.h}).data("target",$image);var origImageObj=new Image;origImageObj.src=$image.attr("src");var sizingText=imageSize.w+"x"+imageSize.h+" ("+this.lang.image.original+": "+origImageObj.width+"x"+origImageObj.height+")";$selection.find(".note-control-selection-info").text(sizingText),this.context.invoke("editor.saveTarget",target)}else this.hide();return isImage}},{key:"hide",value:function hide(){this.context.invoke("editor.clearTarget"),this.$handle.children().hide()}}]),Handle}();function AutoLink_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function AutoLink_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function AutoLink_createClass(Constructor,protoProps,staticProps){return protoProps&&AutoLink_defineProperties(Constructor.prototype,protoProps),staticProps&&AutoLink_defineProperties(Constructor,staticProps),Constructor}var defaultScheme="http://",linkPattern=/^([A-Za-z][A-Za-z0-9+-.]*\:[\/]{2}|tel:|mailto:[A-Z0-9._%+-]+@)?(www\.)?(.+)$/i,AutoLink_AutoLink=function(){function AutoLink(context){var _this=this;AutoLink_classCallCheck(this,AutoLink),this.context=context,this.options=context.options,this.events={"summernote.keyup":function summernoteKeyup(we,e){e.isDefaultPrevented()||_this.handleKeyup(e)},"summernote.keydown":function summernoteKeydown(we,e){_this.handleKeydown(e)}}}return AutoLink_createClass(AutoLink,[{key:"initialize",value:function initialize(){this.lastWordRange=null}},{key:"destroy",value:function destroy(){this.lastWordRange=null}},{key:"replace",value:function replace(){if(this.lastWordRange){var keyword=this.lastWordRange.toString(),match=keyword.match(linkPattern);if(match&&(match[1]||match[2])){var link=match[1]?keyword:"http://"+keyword,urlText=this.options.showDomainOnlyForAutolink?keyword.replace(/^(?:https?:\/\/)?(?:tel?:?)?(?:mailto?:?)?(?:www\.)?/i,"").split("/")[0]:keyword,node=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<a />").html(urlText).attr("href",link)[0];this.context.options.linkTargetBlank&&external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(node).attr("target","_blank"),this.lastWordRange.insertNode(node),this.lastWordRange=null,this.context.invoke("editor.focus")}}}},{key:"handleKeydown",value:function handleKeydown(e){if(lists.contains([core_key.code.ENTER,core_key.code.SPACE],e.keyCode)){var wordRange=this.context.invoke("editor.createRange").getWordRange();this.lastWordRange=wordRange}}},{key:"handleKeyup",value:function handleKeyup(e){lists.contains([core_key.code.ENTER,core_key.code.SPACE],e.keyCode)&&this.replace()}}]),AutoLink}();function AutoSync_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function AutoSync_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function AutoSync_createClass(Constructor,protoProps,staticProps){return protoProps&&AutoSync_defineProperties(Constructor.prototype,protoProps),staticProps&&AutoSync_defineProperties(Constructor,staticProps),Constructor}var AutoSync_AutoSync=function(){function AutoSync(context){var _this=this;AutoSync_classCallCheck(this,AutoSync),this.$note=context.layoutInfo.note,this.events={"summernote.change":function summernoteChange(){_this.$note.val(context.invoke("code"))}}}return AutoSync_createClass(AutoSync,[{key:"shouldInitialize",value:function shouldInitialize(){return dom.isTextarea(this.$note[0])}}]),AutoSync}();function AutoReplace_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function AutoReplace_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function AutoReplace_createClass(Constructor,protoProps,staticProps){return protoProps&&AutoReplace_defineProperties(Constructor.prototype,protoProps),staticProps&&AutoReplace_defineProperties(Constructor,staticProps),Constructor}var AutoReplace_AutoReplace=function(){function AutoReplace(context){var _this=this;AutoReplace_classCallCheck(this,AutoReplace),this.context=context,this.options=context.options.replace||{},this.keys=[core_key.code.ENTER,core_key.code.SPACE,core_key.code.PERIOD,core_key.code.COMMA,core_key.code.SEMICOLON,core_key.code.SLASH],this.previousKeydownCode=null,this.events={"summernote.keyup":function summernoteKeyup(we,e){e.isDefaultPrevented()||_this.handleKeyup(e)},"summernote.keydown":function summernoteKeydown(we,e){_this.handleKeydown(e)}}}return AutoReplace_createClass(AutoReplace,[{key:"shouldInitialize",value:function shouldInitialize(){return!!this.options.match}},{key:"initialize",value:function initialize(){this.lastWord=null}},{key:"destroy",value:function destroy(){this.lastWord=null}},{key:"replace",value:function replace(){if(this.lastWord){var self=this,keyword=this.lastWord.toString();this.options.match(keyword,(function(match){if(match){var node="";if("string"==typeof match?node=dom.createText(match):match instanceof jQuery?node=match[0]:match instanceof Node&&(node=match),!node)return;self.lastWord.insertNode(node),self.lastWord=null,self.context.invoke("editor.focus")}}))}}},{key:"handleKeydown",value:function handleKeydown(e){if(this.previousKeydownCode&&lists.contains(this.keys,this.previousKeydownCode))this.previousKeydownCode=e.keyCode;else{if(lists.contains(this.keys,e.keyCode)){var wordRange=this.context.invoke("editor.createRange").getWordRange();this.lastWord=wordRange}this.previousKeydownCode=e.keyCode}}},{key:"handleKeyup",value:function handleKeyup(e){lists.contains(this.keys,e.keyCode)&&this.replace()}}]),AutoReplace}();function Placeholder_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Placeholder_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Placeholder_createClass(Constructor,protoProps,staticProps){return protoProps&&Placeholder_defineProperties(Constructor.prototype,protoProps),staticProps&&Placeholder_defineProperties(Constructor,staticProps),Constructor}var Placeholder_Placeholder=function(){function Placeholder(context){var _this=this;Placeholder_classCallCheck(this,Placeholder),this.context=context,this.$editingArea=context.layoutInfo.editingArea,this.options=context.options,!0===this.options.inheritPlaceholder&&(this.options.placeholder=this.context.$note.attr("placeholder")||this.options.placeholder),this.events={"summernote.init summernote.change":function summernoteInitSummernoteChange(){_this.update()},"summernote.codeview.toggled":function summernoteCodeviewToggled(){_this.update()}}}return Placeholder_createClass(Placeholder,[{key:"shouldInitialize",value:function shouldInitialize(){return!!this.options.placeholder}},{key:"initialize",value:function initialize(){var _this2=this;this.$placeholder=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()('<div class="note-placeholder">'),this.$placeholder.on("click",(function(){_this2.context.invoke("focus")})).html(this.options.placeholder).prependTo(this.$editingArea),this.update()}},{key:"destroy",value:function destroy(){this.$placeholder.remove()}},{key:"update",value:function update(){var isShow=!this.context.invoke("codeview.isActivated")&&this.context.invoke("editor.isEmpty");this.$placeholder.toggle(isShow)}}]),Placeholder}();function Buttons_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Buttons_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Buttons_createClass(Constructor,protoProps,staticProps){return protoProps&&Buttons_defineProperties(Constructor.prototype,protoProps),staticProps&&Buttons_defineProperties(Constructor,staticProps),Constructor}var Buttons_Buttons=function(){function Buttons(context){Buttons_classCallCheck(this,Buttons),this.ui=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui,this.context=context,this.$toolbar=context.layoutInfo.toolbar,this.options=context.options,this.lang=this.options.langInfo,this.invertedKeyMap=func.invertObject(this.options.keyMap[env.isMac?"mac":"pc"])}return Buttons_createClass(Buttons,[{key:"representShortcut",value:function representShortcut(editorMethod){var shortcut=this.invertedKeyMap[editorMethod];return this.options.shortcuts&&shortcut?(env.isMac&&(shortcut=shortcut.replace("CMD","").replace("SHIFT",""))," ("+(shortcut=shortcut.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]"))+")"):""}},{key:"button",value:function button(o){return!this.options.tooltip&&o.tooltip&&delete o.tooltip,o.container=this.options.container,this.ui.button(o)}},{key:"initialize",value:function initialize(){this.addToolbarButtons(),this.addImagePopoverButtons(),this.addLinkPopoverButtons(),this.addTablePopoverButtons(),this.fontInstalledMap={}}},{key:"destroy",value:function destroy(){delete this.fontInstalledMap}},{key:"isFontInstalled",value:function isFontInstalled(name){return Object.prototype.hasOwnProperty.call(this.fontInstalledMap,name)||(this.fontInstalledMap[name]=env.isFontInstalled(name)||lists.contains(this.options.fontNamesIgnoreCheck,name)),this.fontInstalledMap[name]}},{key:"isFontDeservedToAdd",value:function isFontDeservedToAdd(name){return""!==(name=name.toLowerCase())&&this.isFontInstalled(name)&&-1===env.genericFontFamilies.indexOf(name)}},{key:"colorPalette",value:function colorPalette(className,tooltip,backColor,foreColor){var _this=this;return this.ui.buttonGroup({className:"note-color "+className,children:[this.button({className:"note-current-color-button",contents:this.ui.icon(this.options.icons.font+" note-recent-color"),tooltip:tooltip,click:function click(e){var $button=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(e.currentTarget);backColor&&foreColor?_this.context.invoke("editor.color",{backColor:$button.attr("data-backColor"),foreColor:$button.attr("data-foreColor")}):backColor?_this.context.invoke("editor.color",{backColor:$button.attr("data-backColor")}):foreColor&&_this.context.invoke("editor.color",{foreColor:$button.attr("data-foreColor")})},callback:function callback($button){var $recentColor=$button.find(".note-recent-color");backColor&&($recentColor.css("background-color",_this.options.colorButton.backColor),$button.attr("data-backColor",_this.options.colorButton.backColor)),foreColor?($recentColor.css("color",_this.options.colorButton.foreColor),$button.attr("data-foreColor",_this.options.colorButton.foreColor)):$recentColor.css("color","transparent")}}),this.button({className:"dropdown-toggle",contents:this.ui.dropdownButtonContents("",this.options),tooltip:this.lang.color.more,data:{toggle:"dropdown"}}),this.ui.dropdown({items:(backColor?['<div class="note-palette">','<div class="note-palette-title">'+this.lang.color.background+"</div>","<div>",'<button type="button" class="note-color-reset btn btn-light btn-default" data-event="backColor" data-value="transparent">',this.lang.color.transparent,"</button>","</div>",'<div class="note-holder" data-event="backColor">\x3c!-- back colors --\x3e</div>',"<div>",'<button type="button" class="note-color-select btn btn-light btn-default" data-event="openPalette" data-value = "backColorPicker_'+this.options.id+'">',this.lang.color.cpSelect,"</button>",'<input type="color" id="backColorPicker_'+this.options.id+'" class="note-btn note-color-select-btn" value="'+this.options.colorButton.backColor+'" data-event="backColorPalette">',"</div>",'<div class="note-holder-custom" id="backColorPalette" data-event="backColor"></div>',"</div>"].join(""):"")+(foreColor?['<div class="note-palette">','<div class="note-palette-title">'+this.lang.color.foreground+"</div>","<div>",'<button type="button" class="note-color-reset btn btn-light btn-default" data-event="removeFormat" data-value="foreColor">',this.lang.color.resetToDefault,"</button>","</div>",'<div class="note-holder" data-event="foreColor">\x3c!-- fore colors --\x3e</div>',"<div>",'<button type="button" class="note-color-select btn btn-light btn-default" data-event="openPalette" data-value="foreColorPicker_ '+this.options.id+'">',this.lang.color.cpSelect,"</button>",'<input type="color" id="foreColorPicker_ '+this.options.id+'" class="note-btn note-color-select-btn" value="'+this.options.colorButton.foreColor+'" data-event="foreColorPalette">',"</div>",'<div class="note-holder-custom" id="foreColorPalette" data-event="foreColor"></div>',"</div>"].join(""):""),callback:function callback($dropdown){$dropdown.find(".note-holder").each((function(idx,item){var $holder=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(item);$holder.append(_this.ui.palette({colors:_this.options.colors,colorsName:_this.options.colorsName,eventName:$holder.data("event"),container:_this.options.container,tooltip:_this.options.tooltip}).render())}));var customColors=[["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"]];$dropdown.find(".note-holder-custom").each((function(idx,item){var $holder=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(item);$holder.append(_this.ui.palette({colors:customColors,colorsName:customColors,eventName:$holder.data("event"),container:_this.options.container,tooltip:_this.options.tooltip}).render())})),$dropdown.find("input[type=color]").each((function(idx,item){external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(item).change((function(){var $chip=$dropdown.find("#"+external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(this).data("event")).find(".note-color-btn").first(),color=this.value.toUpperCase();$chip.css("background-color",color).attr("aria-label",color).attr("data-value",color).attr("data-original-title",color),$chip.click()}))}))},click:function click(event){event.stopPropagation();var $parent=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("."+className).find(".note-dropdown-menu"),$button=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(event.target),eventName=$button.data("event"),value=$button.attr("data-value");if("openPalette"===eventName){var $picker=$parent.find("#"+value),$palette=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()($parent.find("#"+$picker.data("event")).find(".note-color-row")[0]),$chip=$palette.find(".note-color-btn").last().detach(),color=$picker.val();$chip.css("background-color",color).attr("aria-label",color).attr("data-value",color).attr("data-original-title",color),$palette.prepend($chip),$picker.click()}else{if(lists.contains(["backColor","foreColor"],eventName)){var key="backColor"===eventName?"background-color":"color",$color=$button.closest(".note-color").find(".note-recent-color"),$currentButton=$button.closest(".note-color").find(".note-current-color-button");$color.css(key,value),$currentButton.attr("data-"+eventName,value)}_this.context.invoke("editor."+eventName,value)}}})]}).render()}},{key:"addToolbarButtons",value:function addToolbarButtons(){var _this2=this;this.context.memo("button.style",(function(){return _this2.ui.buttonGroup([_this2.button({className:"dropdown-toggle",contents:_this2.ui.dropdownButtonContents(_this2.ui.icon(_this2.options.icons.magic),_this2.options),tooltip:_this2.lang.style.style,data:{toggle:"dropdown"}}),_this2.ui.dropdown({className:"dropdown-style",items:_this2.options.styleTags,title:_this2.lang.style.style,template:function template(item){"string"==typeof item&&(item={tag:item,title:Object.prototype.hasOwnProperty.call(_this2.lang.style,item)?_this2.lang.style[item]:item});var tag=item.tag,title=item.title,style,className;return"<"+tag+(item.style?' style="'+item.style+'" ':"")+(item.className?' class="'+item.className+'"':"")+">"+title+"</"+tag+">"},click:_this2.context.createInvokeHandler("editor.formatBlock")})]).render()}));for(var _loop=function _loop(styleIdx,styleLen){var item=_this2.options.styleTags[styleIdx];_this2.context.memo("button.style."+item,(function(){return _this2.button({className:"note-btn-style-"+item,contents:'<div data-value="'+item+'">'+item.toUpperCase()+"</div>",tooltip:_this2.lang.style[item],click:_this2.context.createInvokeHandler("editor.formatBlock")}).render()}))},styleIdx=0,styleLen=this.options.styleTags.length;styleIdx<styleLen;styleIdx++)_loop(styleIdx,styleLen);this.context.memo("button.bold",(function(){return _this2.button({className:"note-btn-bold",contents:_this2.ui.icon(_this2.options.icons.bold),tooltip:_this2.lang.font.bold+_this2.representShortcut("bold"),click:_this2.context.createInvokeHandlerAndUpdateState("editor.bold")}).render()})),this.context.memo("button.italic",(function(){return _this2.button({className:"note-btn-italic",contents:_this2.ui.icon(_this2.options.icons.italic),tooltip:_this2.lang.font.italic+_this2.representShortcut("italic"),click:_this2.context.createInvokeHandlerAndUpdateState("editor.italic")}).render()})),this.context.memo("button.underline",(function(){return _this2.button({className:"note-btn-underline",contents:_this2.ui.icon(_this2.options.icons.underline),tooltip:_this2.lang.font.underline+_this2.representShortcut("underline"),click:_this2.context.createInvokeHandlerAndUpdateState("editor.underline")}).render()})),this.context.memo("button.clear",(function(){return _this2.button({contents:_this2.ui.icon(_this2.options.icons.eraser),tooltip:_this2.lang.font.clear+_this2.representShortcut("removeFormat"),click:_this2.context.createInvokeHandler("editor.removeFormat")}).render()})),this.context.memo("button.strikethrough",(function(){return _this2.button({className:"note-btn-strikethrough",contents:_this2.ui.icon(_this2.options.icons.strikethrough),tooltip:_this2.lang.font.strikethrough+_this2.representShortcut("strikethrough"),click:_this2.context.createInvokeHandlerAndUpdateState("editor.strikethrough")}).render()})),this.context.memo("button.superscript",(function(){return _this2.button({className:"note-btn-superscript",contents:_this2.ui.icon(_this2.options.icons.superscript),tooltip:_this2.lang.font.superscript,click:_this2.context.createInvokeHandlerAndUpdateState("editor.superscript")}).render()})),this.context.memo("button.subscript",(function(){return _this2.button({className:"note-btn-subscript",contents:_this2.ui.icon(_this2.options.icons.subscript),tooltip:_this2.lang.font.subscript,click:_this2.context.createInvokeHandlerAndUpdateState("editor.subscript")}).render()})),this.context.memo("button.fontname",(function(){var styleInfo=_this2.context.invoke("editor.currentStyle");return _this2.options.addDefaultFonts&&external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(styleInfo["font-family"].split(","),(function(idx,fontname){fontname=fontname.trim().replace(/['"]+/g,""),_this2.isFontDeservedToAdd(fontname)&&-1===_this2.options.fontNames.indexOf(fontname)&&_this2.options.fontNames.push(fontname)})),_this2.ui.buttonGroup([_this2.button({className:"dropdown-toggle",contents:_this2.ui.dropdownButtonContents('<span class="note-current-fontname"></span>',_this2.options),tooltip:_this2.lang.font.name,data:{toggle:"dropdown"}}),_this2.ui.dropdownCheck({className:"dropdown-fontname",checkClassName:_this2.options.icons.menuCheck,items:_this2.options.fontNames.filter(_this2.isFontInstalled.bind(_this2)),title:_this2.lang.font.name,template:function template(item){return'<span style="font-family: '+env.validFontName(item)+'">'+item+"</span>"},click:_this2.context.createInvokeHandlerAndUpdateState("editor.fontName")})]).render()})),this.context.memo("button.fontsize",(function(){return _this2.ui.buttonGroup([_this2.button({className:"dropdown-toggle",contents:_this2.ui.dropdownButtonContents('<span class="note-current-fontsize"></span>',_this2.options),tooltip:_this2.lang.font.size,data:{toggle:"dropdown"}}),_this2.ui.dropdownCheck({className:"dropdown-fontsize",checkClassName:_this2.options.icons.menuCheck,items:_this2.options.fontSizes,title:_this2.lang.font.size,click:_this2.context.createInvokeHandlerAndUpdateState("editor.fontSize")})]).render()})),this.context.memo("button.fontsizeunit",(function(){return _this2.ui.buttonGroup([_this2.button({className:"dropdown-toggle",contents:_this2.ui.dropdownButtonContents('<span class="note-current-fontsizeunit"></span>',_this2.options),tooltip:_this2.lang.font.sizeunit,data:{toggle:"dropdown"}}),_this2.ui.dropdownCheck({className:"dropdown-fontsizeunit",checkClassName:_this2.options.icons.menuCheck,items:_this2.options.fontSizeUnits,title:_this2.lang.font.sizeunit,click:_this2.context.createInvokeHandlerAndUpdateState("editor.fontSizeUnit")})]).render()})),this.context.memo("button.color",(function(){return _this2.colorPalette("note-color-all",_this2.lang.color.recent,!0,!0)})),this.context.memo("button.forecolor",(function(){return _this2.colorPalette("note-color-fore",_this2.lang.color.foreground,!1,!0)})),this.context.memo("button.backcolor",(function(){return _this2.colorPalette("note-color-back",_this2.lang.color.background,!0,!1)})),this.context.memo("button.ul",(function(){return _this2.button({contents:_this2.ui.icon(_this2.options.icons.unorderedlist),tooltip:_this2.lang.lists.unordered+_this2.representShortcut("insertUnorderedList"),click:_this2.context.createInvokeHandler("editor.insertUnorderedList")}).render()})),this.context.memo("button.ol",(function(){return _this2.button({contents:_this2.ui.icon(_this2.options.icons.orderedlist),tooltip:_this2.lang.lists.ordered+_this2.representShortcut("insertOrderedList"),click:_this2.context.createInvokeHandler("editor.insertOrderedList")}).render()}));var justifyLeft=this.button({contents:this.ui.icon(this.options.icons.alignLeft),tooltip:this.lang.paragraph.left+this.representShortcut("justifyLeft"),click:this.context.createInvokeHandler("editor.justifyLeft")}),justifyCenter=this.button({contents:this.ui.icon(this.options.icons.alignCenter),tooltip:this.lang.paragraph.center+this.representShortcut("justifyCenter"),click:this.context.createInvokeHandler("editor.justifyCenter")}),justifyRight=this.button({contents:this.ui.icon(this.options.icons.alignRight),tooltip:this.lang.paragraph.right+this.representShortcut("justifyRight"),click:this.context.createInvokeHandler("editor.justifyRight")}),justifyFull=this.button({contents:this.ui.icon(this.options.icons.alignJustify),tooltip:this.lang.paragraph.justify+this.representShortcut("justifyFull"),click:this.context.createInvokeHandler("editor.justifyFull")}),outdent=this.button({contents:this.ui.icon(this.options.icons.outdent),tooltip:this.lang.paragraph.outdent+this.representShortcut("outdent"),click:this.context.createInvokeHandler("editor.outdent")}),indent=this.button({contents:this.ui.icon(this.options.icons.indent),tooltip:this.lang.paragraph.indent+this.representShortcut("indent"),click:this.context.createInvokeHandler("editor.indent")});this.context.memo("button.justifyLeft",func.invoke(justifyLeft,"render")),this.context.memo("button.justifyCenter",func.invoke(justifyCenter,"render")),this.context.memo("button.justifyRight",func.invoke(justifyRight,"render")),this.context.memo("button.justifyFull",func.invoke(justifyFull,"render")),this.context.memo("button.outdent",func.invoke(outdent,"render")),this.context.memo("button.indent",func.invoke(indent,"render")),this.context.memo("button.paragraph",(function(){return _this2.ui.buttonGroup([_this2.button({className:"dropdown-toggle",contents:_this2.ui.dropdownButtonContents(_this2.ui.icon(_this2.options.icons.alignLeft),_this2.options),tooltip:_this2.lang.paragraph.paragraph,data:{toggle:"dropdown"}}),_this2.ui.dropdown([_this2.ui.buttonGroup({className:"note-align",children:[justifyLeft,justifyCenter,justifyRight,justifyFull]}),_this2.ui.buttonGroup({className:"note-list",children:[outdent,indent]})])]).render()})),this.context.memo("button.height",(function(){return _this2.ui.buttonGroup([_this2.button({className:"dropdown-toggle",contents:_this2.ui.dropdownButtonContents(_this2.ui.icon(_this2.options.icons.textHeight),_this2.options),tooltip:_this2.lang.font.height,data:{toggle:"dropdown"}}),_this2.ui.dropdownCheck({items:_this2.options.lineHeights,checkClassName:_this2.options.icons.menuCheck,className:"dropdown-line-height",title:_this2.lang.font.height,click:_this2.context.createInvokeHandler("editor.lineHeight")})]).render()})),this.context.memo("button.table",(function(){return _this2.ui.buttonGroup([_this2.button({className:"dropdown-toggle",contents:_this2.ui.dropdownButtonContents(_this2.ui.icon(_this2.options.icons.table),_this2.options),tooltip:_this2.lang.table.table,data:{toggle:"dropdown"}}),_this2.ui.dropdown({title:_this2.lang.table.table,className:"note-table",items:['<div class="note-dimension-picker">','<div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div>','<div class="note-dimension-picker-highlighted"></div>','<div class="note-dimension-picker-unhighlighted"></div>',"</div>",'<div class="note-dimension-display">1 x 1</div>'].join("")})],{callback:function callback($node){var $catcher;$node.find(".note-dimension-picker-mousecatcher").css({width:_this2.options.insertTableMaxSize.col+"em",height:_this2.options.insertTableMaxSize.row+"em"}).mousedown(_this2.context.createInvokeHandler("editor.insertTable")).on("mousemove",_this2.tableMoveHandler.bind(_this2))}}).render()})),this.context.memo("button.link",(function(){return _this2.button({contents:_this2.ui.icon(_this2.options.icons.link),tooltip:_this2.lang.link.link+_this2.representShortcut("linkDialog.show"),click:_this2.context.createInvokeHandler("linkDialog.show")}).render()})),this.context.memo("button.picture",(function(){return _this2.button({contents:_this2.ui.icon(_this2.options.icons.picture),tooltip:_this2.lang.image.image,click:_this2.context.createInvokeHandler("imageDialog.show")}).render()})),this.context.memo("button.video",(function(){return _this2.button({contents:_this2.ui.icon(_this2.options.icons.video),tooltip:_this2.lang.video.video,click:_this2.context.createInvokeHandler("videoDialog.show")}).render()})),this.context.memo("button.hr",(function(){return _this2.button({contents:_this2.ui.icon(_this2.options.icons.minus),tooltip:_this2.lang.hr.insert+_this2.representShortcut("insertHorizontalRule"),click:_this2.context.createInvokeHandler("editor.insertHorizontalRule")}).render()})),this.context.memo("button.fullscreen",(function(){return _this2.button({className:"btn-fullscreen note-codeview-keep",contents:_this2.ui.icon(_this2.options.icons.arrowsAlt),tooltip:_this2.lang.options.fullscreen,click:_this2.context.createInvokeHandler("fullscreen.toggle")}).render()})),this.context.memo("button.codeview",(function(){return _this2.button({className:"btn-codeview note-codeview-keep",contents:_this2.ui.icon(_this2.options.icons.code),tooltip:_this2.lang.options.codeview,click:_this2.context.createInvokeHandler("codeview.toggle")}).render()})),this.context.memo("button.redo",(function(){return _this2.button({contents:_this2.ui.icon(_this2.options.icons.redo),tooltip:_this2.lang.history.redo+_this2.representShortcut("redo"),click:_this2.context.createInvokeHandler("editor.redo")}).render()})),this.context.memo("button.undo",(function(){return _this2.button({contents:_this2.ui.icon(_this2.options.icons.undo),tooltip:_this2.lang.history.undo+_this2.representShortcut("undo"),click:_this2.context.createInvokeHandler("editor.undo")}).render()})),this.context.memo("button.help",(function(){return _this2.button({contents:_this2.ui.icon(_this2.options.icons.question),tooltip:_this2.lang.options.help,click:_this2.context.createInvokeHandler("helpDialog.show")}).render()}))}},{key:"addImagePopoverButtons",value:function addImagePopoverButtons(){var _this3=this;this.context.memo("button.resizeFull",(function(){return _this3.button({contents:'<span class="note-fontsize-10">100%</span>',tooltip:_this3.lang.image.resizeFull,click:_this3.context.createInvokeHandler("editor.resize","1")}).render()})),this.context.memo("button.resizeHalf",(function(){return _this3.button({contents:'<span class="note-fontsize-10">50%</span>',tooltip:_this3.lang.image.resizeHalf,click:_this3.context.createInvokeHandler("editor.resize","0.5")}).render()})),this.context.memo("button.resizeQuarter",(function(){return _this3.button({contents:'<span class="note-fontsize-10">25%</span>',tooltip:_this3.lang.image.resizeQuarter,click:_this3.context.createInvokeHandler("editor.resize","0.25")}).render()})),this.context.memo("button.resizeNone",(function(){return _this3.button({contents:_this3.ui.icon(_this3.options.icons.rollback),tooltip:_this3.lang.image.resizeNone,click:_this3.context.createInvokeHandler("editor.resize","0")}).render()})),this.context.memo("button.floatLeft",(function(){return _this3.button({contents:_this3.ui.icon(_this3.options.icons.floatLeft),tooltip:_this3.lang.image.floatLeft,click:_this3.context.createInvokeHandler("editor.floatMe","left")}).render()})),this.context.memo("button.floatRight",(function(){return _this3.button({contents:_this3.ui.icon(_this3.options.icons.floatRight),tooltip:_this3.lang.image.floatRight,click:_this3.context.createInvokeHandler("editor.floatMe","right")}).render()})),this.context.memo("button.floatNone",(function(){return _this3.button({contents:_this3.ui.icon(_this3.options.icons.rollback),tooltip:_this3.lang.image.floatNone,click:_this3.context.createInvokeHandler("editor.floatMe","none")}).render()})),this.context.memo("button.removeMedia",(function(){return _this3.button({contents:_this3.ui.icon(_this3.options.icons.trash),tooltip:_this3.lang.image.remove,click:_this3.context.createInvokeHandler("editor.removeMedia")}).render()}))}},{key:"addLinkPopoverButtons",value:function addLinkPopoverButtons(){var _this4=this;this.context.memo("button.linkDialogShow",(function(){return _this4.button({contents:_this4.ui.icon(_this4.options.icons.link),tooltip:_this4.lang.link.edit,click:_this4.context.createInvokeHandler("linkDialog.show")}).render()})),this.context.memo("button.unlink",(function(){return _this4.button({contents:_this4.ui.icon(_this4.options.icons.unlink),tooltip:_this4.lang.link.unlink,click:_this4.context.createInvokeHandler("editor.unlink")}).render()}))}},{key:"addTablePopoverButtons",value:function addTablePopoverButtons(){var _this5=this;this.context.memo("button.addRowUp",(function(){return _this5.button({className:"btn-md",contents:_this5.ui.icon(_this5.options.icons.rowAbove),tooltip:_this5.lang.table.addRowAbove,click:_this5.context.createInvokeHandler("editor.addRow","top")}).render()})),this.context.memo("button.addRowDown",(function(){return _this5.button({className:"btn-md",contents:_this5.ui.icon(_this5.options.icons.rowBelow),tooltip:_this5.lang.table.addRowBelow,click:_this5.context.createInvokeHandler("editor.addRow","bottom")}).render()})),this.context.memo("button.addColLeft",(function(){return _this5.button({className:"btn-md",contents:_this5.ui.icon(_this5.options.icons.colBefore),tooltip:_this5.lang.table.addColLeft,click:_this5.context.createInvokeHandler("editor.addCol","left")}).render()})),this.context.memo("button.addColRight",(function(){return _this5.button({className:"btn-md",contents:_this5.ui.icon(_this5.options.icons.colAfter),tooltip:_this5.lang.table.addColRight,click:_this5.context.createInvokeHandler("editor.addCol","right")}).render()})),this.context.memo("button.deleteRow",(function(){return _this5.button({className:"btn-md",contents:_this5.ui.icon(_this5.options.icons.rowRemove),tooltip:_this5.lang.table.delRow,click:_this5.context.createInvokeHandler("editor.deleteRow")}).render()})),this.context.memo("button.deleteCol",(function(){return _this5.button({className:"btn-md",contents:_this5.ui.icon(_this5.options.icons.colRemove),tooltip:_this5.lang.table.delCol,click:_this5.context.createInvokeHandler("editor.deleteCol")}).render()})),this.context.memo("button.deleteTable",(function(){return _this5.button({className:"btn-md",contents:_this5.ui.icon(_this5.options.icons.trash),tooltip:_this5.lang.table.delTable,click:_this5.context.createInvokeHandler("editor.deleteTable")}).render()}))}},{key:"build",value:function build($container,groups){for(var groupIdx=0,groupLen=groups.length;groupIdx<groupLen;groupIdx++){for(var group=groups[groupIdx],groupName=Array.isArray(group)?group[0]:group,buttons=Array.isArray(group)?1===group.length?[group[0]]:group[1]:[group],$group=this.ui.buttonGroup({className:"note-"+groupName}).render(),idx=0,len=buttons.length;idx<len;idx++){var btn=this.context.memo("button."+buttons[idx]);btn&&$group.append("function"==typeof btn?btn(this.context):btn)}$group.appendTo($container)}}},{key:"updateCurrentStyle",value:function updateCurrentStyle($container){var _this6=this,$cont=$container||this.$toolbar,styleInfo=this.context.invoke("editor.currentStyle");if(this.updateBtnStates($cont,{".note-btn-bold":function noteBtnBold(){return"bold"===styleInfo["font-bold"]},".note-btn-italic":function noteBtnItalic(){return"italic"===styleInfo["font-italic"]},".note-btn-underline":function noteBtnUnderline(){return"underline"===styleInfo["font-underline"]},".note-btn-subscript":function noteBtnSubscript(){return"subscript"===styleInfo["font-subscript"]},".note-btn-superscript":function noteBtnSuperscript(){return"superscript"===styleInfo["font-superscript"]},".note-btn-strikethrough":function noteBtnStrikethrough(){return"strikethrough"===styleInfo["font-strikethrough"]}}),styleInfo["font-family"]){var fontNames=styleInfo["font-family"].split(",").map((function(name){return name.replace(/[\'\"]/g,"").replace(/\s+$/,"").replace(/^\s+/,"")})),fontName=lists.find(fontNames,this.isFontInstalled.bind(this));$cont.find(".dropdown-fontname a").each((function(idx,item){var $item=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(item),isChecked=$item.data("value")+""==fontName+"";$item.toggleClass("checked",isChecked)})),$cont.find(".note-current-fontname").text(fontName).css("font-family",fontName)}if(styleInfo["font-size"]){var fontSize=styleInfo["font-size"];$cont.find(".dropdown-fontsize a").each((function(idx,item){var $item=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(item),isChecked=$item.data("value")+""==fontSize+"";$item.toggleClass("checked",isChecked)})),$cont.find(".note-current-fontsize").text(fontSize);var fontSizeUnit=styleInfo["font-size-unit"];$cont.find(".dropdown-fontsizeunit a").each((function(idx,item){var $item=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(item),isChecked=$item.data("value")+""==fontSizeUnit+"";$item.toggleClass("checked",isChecked)})),$cont.find(".note-current-fontsizeunit").text(fontSizeUnit)}if(styleInfo["line-height"]){var lineHeight=styleInfo["line-height"];$cont.find(".dropdown-line-height li a").each((function(idx,item){var isChecked=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(item).data("value")+""==lineHeight+"";_this6.className=isChecked?"checked":""}))}}},{key:"updateBtnStates",value:function updateBtnStates($container,infos){var _this7=this;external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.each(infos,(function(selector,pred){_this7.ui.toggleBtnActive($container.find(selector),pred())}))}},{key:"tableMoveHandler",value:function tableMoveHandler(event){var PX_PER_EM=18,$picker=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(event.target.parentNode),$dimensionDisplay=$picker.next(),$catcher=$picker.find(".note-dimension-picker-mousecatcher"),$highlighted=$picker.find(".note-dimension-picker-highlighted"),$unhighlighted=$picker.find(".note-dimension-picker-unhighlighted"),posOffset;if(void 0===event.offsetX){var posCatcher=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(event.target).offset();posOffset={x:event.pageX-posCatcher.left,y:event.pageY-posCatcher.top}}else posOffset={x:event.offsetX,y:event.offsetY};var dim_c=Math.ceil(posOffset.x/18)||1,dim_r=Math.ceil(posOffset.y/18)||1;$highlighted.css({width:dim_c+"em",height:dim_r+"em"}),$catcher.data("value",dim_c+"x"+dim_r),dim_c>3&&dim_c<this.options.insertTableMaxSize.col&&$unhighlighted.css({width:dim_c+1+"em"}),dim_r>3&&dim_r<this.options.insertTableMaxSize.row&&$unhighlighted.css({height:dim_r+1+"em"}),$dimensionDisplay.html(dim_c+" x "+dim_r)}}]),Buttons}();function Toolbar_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Toolbar_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Toolbar_createClass(Constructor,protoProps,staticProps){return protoProps&&Toolbar_defineProperties(Constructor.prototype,protoProps),staticProps&&Toolbar_defineProperties(Constructor,staticProps),Constructor}var Toolbar_Toolbar=function(){function Toolbar(context){Toolbar_classCallCheck(this,Toolbar),this.context=context,this.$window=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(window),this.$document=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(document),this.ui=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui,this.$note=context.layoutInfo.note,this.$editor=context.layoutInfo.editor,this.$toolbar=context.layoutInfo.toolbar,this.$editable=context.layoutInfo.editable,this.$statusbar=context.layoutInfo.statusbar,this.options=context.options,this.isFollowing=!1,this.followScroll=this.followScroll.bind(this)}return Toolbar_createClass(Toolbar,[{key:"shouldInitialize",value:function shouldInitialize(){return!this.options.airMode}},{key:"initialize",value:function initialize(){var _this=this;this.options.toolbar=this.options.toolbar||[],this.options.toolbar.length?this.context.invoke("buttons.build",this.$toolbar,this.options.toolbar):this.$toolbar.hide(),this.options.toolbarContainer&&this.$toolbar.appendTo(this.options.toolbarContainer),this.changeContainer(!1),this.$note.on("summernote.keyup summernote.mouseup summernote.change",(function(){_this.context.invoke("buttons.updateCurrentStyle")})),this.context.invoke("buttons.updateCurrentStyle"),this.options.followingToolbar&&this.$window.on("scroll resize",this.followScroll)}},{key:"destroy",value:function destroy(){this.$toolbar.children().remove(),this.options.followingToolbar&&this.$window.off("scroll resize",this.followScroll)}},{key:"followScroll",value:function followScroll(){if(this.$editor.hasClass("fullscreen"))return!1;var editorHeight=this.$editor.outerHeight(),editorWidth=this.$editor.width(),toolbarHeight=this.$toolbar.height(),statusbarHeight=this.$statusbar.height(),otherBarHeight=0;this.options.otherStaticBar&&(otherBarHeight=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(this.options.otherStaticBar).outerHeight());var currentOffset=this.$document.scrollTop(),editorOffsetTop=this.$editor.offset().top,editorOffsetBottom,activateOffset=editorOffsetTop-otherBarHeight,deactivateOffsetBottom=editorOffsetTop+editorHeight-otherBarHeight-toolbarHeight-statusbarHeight;!this.isFollowing&&currentOffset>activateOffset&&currentOffset<deactivateOffsetBottom-toolbarHeight?(this.isFollowing=!0,this.$editable.css({marginTop:this.$toolbar.outerHeight()}),this.$toolbar.css({position:"fixed",top:otherBarHeight,width:editorWidth,zIndex:1e3})):this.isFollowing&&(currentOffset<activateOffset||currentOffset>deactivateOffsetBottom)&&(this.isFollowing=!1,this.$toolbar.css({position:"relative",top:0,width:"100%",zIndex:"auto"}),this.$editable.css({marginTop:""}))}},{key:"changeContainer",value:function changeContainer(isFullscreen){isFullscreen?this.$toolbar.prependTo(this.$editor):this.options.toolbarContainer&&this.$toolbar.appendTo(this.options.toolbarContainer),this.options.followingToolbar&&this.followScroll()}},{key:"updateFullscreen",value:function updateFullscreen(isFullscreen){this.ui.toggleBtnActive(this.$toolbar.find(".btn-fullscreen"),isFullscreen),this.changeContainer(isFullscreen)}},{key:"updateCodeview",value:function updateCodeview(isCodeview){this.ui.toggleBtnActive(this.$toolbar.find(".btn-codeview"),isCodeview),isCodeview?this.deactivate():this.activate()}},{key:"activate",value:function activate(isIncludeCodeview){var $btn=this.$toolbar.find("button");isIncludeCodeview||($btn=$btn.not(".note-codeview-keep")),this.ui.toggleBtn($btn,!0)}},{key:"deactivate",value:function deactivate(isIncludeCodeview){var $btn=this.$toolbar.find("button");isIncludeCodeview||($btn=$btn.not(".note-codeview-keep")),this.ui.toggleBtn($btn,!1)}}]),Toolbar}();function LinkDialog_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function LinkDialog_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function LinkDialog_createClass(Constructor,protoProps,staticProps){return protoProps&&LinkDialog_defineProperties(Constructor.prototype,protoProps),staticProps&&LinkDialog_defineProperties(Constructor,staticProps),Constructor}var LinkDialog_LinkDialog=function(){function LinkDialog(context){LinkDialog_classCallCheck(this,LinkDialog),this.context=context,this.ui=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui,this.$body=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(document.body),this.$editor=context.layoutInfo.editor,this.options=context.options,this.lang=this.options.langInfo,context.memo("help.linkDialog.show",this.options.langInfo.help["linkDialog.show"])}return LinkDialog_createClass(LinkDialog,[{key:"initialize",value:function initialize(){var $container=this.options.dialogsInBody?this.$body:this.options.container,body=['<div class="form-group note-form-group">','<label for="note-dialog-link-txt-'.concat(this.options.id,'" class="note-form-label">').concat(this.lang.link.textToDisplay,"</label>"),'<input id="note-dialog-link-txt-'.concat(this.options.id,'" class="note-link-text form-control note-form-control note-input" type="text"/>'),"</div>",'<div class="form-group note-form-group">','<label for="note-dialog-link-url-'.concat(this.options.id,'" class="note-form-label">').concat(this.lang.link.url,"</label>"),'<input id="note-dialog-link-url-'.concat(this.options.id,'" class="note-link-url form-control note-form-control note-input" type="text" value="http://"/>'),"</div>",this.options.disableLinkTarget?"":external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<div/>").append(this.ui.checkbox({className:"sn-checkbox-open-in-new-window",text:this.lang.link.openInNewWindow,checked:!0}).render()).html(),external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<div/>").append(this.ui.checkbox({className:"sn-checkbox-use-protocol",text:this.lang.link.useProtocol,checked:!0}).render()).html()].join(""),buttonClass,footer='<input type="button" href="#" class="'.concat("btn btn-primary note-btn note-btn-primary note-link-btn",'" value="').concat(this.lang.link.insert,'" disabled>');this.$dialog=this.ui.dialog({className:"link-dialog",title:this.lang.link.insert,fade:this.options.dialogsFade,body:body,footer:footer}).render().appendTo($container)}},{key:"destroy",value:function destroy(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()}},{key:"bindEnterKey",value:function bindEnterKey($input,$btn){$input.on("keypress",(function(event){event.keyCode===core_key.code.ENTER&&(event.preventDefault(),$btn.trigger("click"))}))}},{key:"toggleLinkBtn",value:function toggleLinkBtn($linkBtn,$linkText,$linkUrl){this.ui.toggleBtn($linkBtn,$linkText.val()&&$linkUrl.val())}},{key:"showLinkDialog",value:function showLinkDialog(linkInfo){var _this=this;return external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.Deferred((function(deferred){var $linkText=_this.$dialog.find(".note-link-text"),$linkUrl=_this.$dialog.find(".note-link-url"),$linkBtn=_this.$dialog.find(".note-link-btn"),$openInNewWindow=_this.$dialog.find(".sn-checkbox-open-in-new-window input[type=checkbox]"),$useProtocol=_this.$dialog.find(".sn-checkbox-use-protocol input[type=checkbox]");_this.ui.onDialogShown(_this.$dialog,(function(){_this.context.triggerEvent("dialog.shown"),!linkInfo.url&&func.isValidUrl(linkInfo.text)&&(linkInfo.url=linkInfo.text),$linkText.on("input paste propertychange",(function(){linkInfo.text=$linkText.val(),_this.toggleLinkBtn($linkBtn,$linkText,$linkUrl)})).val(linkInfo.text),$linkUrl.on("input paste propertychange",(function(){linkInfo.text||$linkText.val($linkUrl.val()),_this.toggleLinkBtn($linkBtn,$linkText,$linkUrl)})).val(linkInfo.url),env.isSupportTouch||$linkUrl.trigger("focus"),_this.toggleLinkBtn($linkBtn,$linkText,$linkUrl),_this.bindEnterKey($linkUrl,$linkBtn),_this.bindEnterKey($linkText,$linkBtn);var isNewWindowChecked=void 0!==linkInfo.isNewWindow?linkInfo.isNewWindow:_this.context.options.linkTargetBlank;$openInNewWindow.prop("checked",isNewWindowChecked);var useProtocolChecked=!linkInfo.url&&_this.context.options.useProtocol;$useProtocol.prop("checked",useProtocolChecked),$linkBtn.one("click",(function(event){event.preventDefault(),deferred.resolve({range:linkInfo.range,url:$linkUrl.val(),text:$linkText.val(),isNewWindow:$openInNewWindow.is(":checked"),checkProtocol:$useProtocol.is(":checked")}),_this.ui.hideDialog(_this.$dialog)}))})),_this.ui.onDialogHidden(_this.$dialog,(function(){$linkText.off(),$linkUrl.off(),$linkBtn.off(),"pending"===deferred.state()&&deferred.reject()})),_this.ui.showDialog(_this.$dialog)})).promise()}},{key:"show",value:function show(){var _this2=this,linkInfo=this.context.invoke("editor.getLinkInfo");this.context.invoke("editor.saveRange"),this.showLinkDialog(linkInfo).then((function(linkInfo){_this2.context.invoke("editor.restoreRange"),_this2.context.invoke("editor.createLink",linkInfo)})).fail((function(){_this2.context.invoke("editor.restoreRange")}))}}]),LinkDialog}();function LinkPopover_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function LinkPopover_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function LinkPopover_createClass(Constructor,protoProps,staticProps){return protoProps&&LinkPopover_defineProperties(Constructor.prototype,protoProps),staticProps&&LinkPopover_defineProperties(Constructor,staticProps),Constructor}var LinkPopover_LinkPopover=function(){function LinkPopover(context){var _this=this;LinkPopover_classCallCheck(this,LinkPopover),this.context=context,this.ui=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui,this.options=context.options,this.events={"summernote.keyup summernote.mouseup summernote.change summernote.scroll":function summernoteKeyupSummernoteMouseupSummernoteChangeSummernoteScroll(){_this.update()},"summernote.disable summernote.dialog.shown summernote.blur":function summernoteDisableSummernoteDialogShownSummernoteBlur(){_this.hide()}}}return LinkPopover_createClass(LinkPopover,[{key:"shouldInitialize",value:function shouldInitialize(){return!lists.isEmpty(this.options.popover.link)}},{key:"initialize",value:function initialize(){this.$popover=this.ui.popover({className:"note-link-popover",callback:function callback($node){var $content;$node.find(".popover-content,.note-popover-content").prepend('<span><a target="_blank"></a>&nbsp;</span>')}}).render().appendTo(this.options.container);var $content=this.$popover.find(".popover-content,.note-popover-content");this.context.invoke("buttons.build",$content,this.options.popover.link),this.$popover.on("mousedown",(function(e){e.preventDefault()}))}},{key:"destroy",value:function destroy(){this.$popover.remove()}},{key:"update",value:function update(){if(this.context.invoke("editor.hasFocus")){var rng=this.context.invoke("editor.getLastRange");if(rng.isCollapsed()&&rng.isOnAnchor()){var anchor=dom.ancestor(rng.sc,dom.isAnchor),href=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(anchor).attr("href");this.$popover.find("a").attr("href",href).text(href);var pos=dom.posFromPlaceholder(anchor),containerOffset=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(this.options.container).offset();pos.top-=containerOffset.top,pos.left-=containerOffset.left,this.$popover.css({display:"block",left:pos.left,top:pos.top})}else this.hide()}else this.hide()}},{key:"hide",value:function hide(){this.$popover.hide()}}]),LinkPopover}();function ImageDialog_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function ImageDialog_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function ImageDialog_createClass(Constructor,protoProps,staticProps){return protoProps&&ImageDialog_defineProperties(Constructor.prototype,protoProps),staticProps&&ImageDialog_defineProperties(Constructor,staticProps),Constructor}var ImageDialog_ImageDialog=function(){function ImageDialog(context){ImageDialog_classCallCheck(this,ImageDialog),this.context=context,this.ui=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui,this.$body=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(document.body),this.$editor=context.layoutInfo.editor,this.options=context.options,this.lang=this.options.langInfo}return ImageDialog_createClass(ImageDialog,[{key:"initialize",value:function initialize(){var imageLimitation="";if(this.options.maximumImageFileSize){var unit=Math.floor(Math.log(this.options.maximumImageFileSize)/Math.log(1024)),readableSize=1*(this.options.maximumImageFileSize/Math.pow(1024,unit)).toFixed(2)+" "+" KMGTP"[unit]+"B";imageLimitation="<small>".concat(this.lang.image.maximumFileSize+" : "+readableSize,"</small>")}var $container=this.options.dialogsInBody?this.$body:this.options.container,body=['<div class="form-group note-form-group note-group-select-from-files">','<label for="note-dialog-image-file-'+this.options.id+'" class="note-form-label">'+this.lang.image.selectFromFiles+"</label>",'<input id="note-dialog-image-file-'+this.options.id+'" class="note-image-input form-control-file note-form-control note-input" ',' type="file" name="files" accept="image/*" multiple="multiple"/>',imageLimitation,"</div>",'<div class="form-group note-group-image-url">','<label for="note-dialog-image-url-'+this.options.id+'" class="note-form-label">'+this.lang.image.url+"</label>",'<input id="note-dialog-image-url-'+this.options.id+'" class="note-image-url form-control note-form-control note-input" type="text"/>',"</div>"].join(""),buttonClass,footer='<input type="button" href="#" class="'.concat("btn btn-primary note-btn note-btn-primary note-image-btn",'" value="').concat(this.lang.image.insert,'" disabled>');this.$dialog=this.ui.dialog({title:this.lang.image.insert,fade:this.options.dialogsFade,body:body,footer:footer}).render().appendTo($container)}},{key:"destroy",value:function destroy(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()}},{key:"bindEnterKey",value:function bindEnterKey($input,$btn){$input.on("keypress",(function(event){event.keyCode===core_key.code.ENTER&&(event.preventDefault(),$btn.trigger("click"))}))}},{key:"show",value:function show(){var _this=this;this.context.invoke("editor.saveRange"),this.showImageDialog().then((function(data){_this.ui.hideDialog(_this.$dialog),_this.context.invoke("editor.restoreRange"),"string"==typeof data?_this.options.callbacks.onImageLinkInsert?_this.context.triggerEvent("image.link.insert",data):_this.context.invoke("editor.insertImage",data):_this.context.invoke("editor.insertImagesOrCallback",data)})).fail((function(){_this.context.invoke("editor.restoreRange")}))}},{key:"showImageDialog",value:function showImageDialog(){var _this2=this;return external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.Deferred((function(deferred){var $imageInput=_this2.$dialog.find(".note-image-input"),$imageUrl=_this2.$dialog.find(".note-image-url"),$imageBtn=_this2.$dialog.find(".note-image-btn");_this2.ui.onDialogShown(_this2.$dialog,(function(){_this2.context.triggerEvent("dialog.shown"),$imageInput.replaceWith($imageInput.clone().on("change",(function(event){deferred.resolve(event.target.files||event.target.value)})).val("")),$imageUrl.on("input paste propertychange",(function(){_this2.ui.toggleBtn($imageBtn,$imageUrl.val())})).val(""),env.isSupportTouch||$imageUrl.trigger("focus"),$imageBtn.click((function(event){event.preventDefault(),deferred.resolve($imageUrl.val())})),_this2.bindEnterKey($imageUrl,$imageBtn)})),_this2.ui.onDialogHidden(_this2.$dialog,(function(){$imageInput.off(),$imageUrl.off(),$imageBtn.off(),"pending"===deferred.state()&&deferred.reject()})),_this2.ui.showDialog(_this2.$dialog)}))}}]),ImageDialog}();function ImagePopover_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function ImagePopover_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function ImagePopover_createClass(Constructor,protoProps,staticProps){return protoProps&&ImagePopover_defineProperties(Constructor.prototype,protoProps),staticProps&&ImagePopover_defineProperties(Constructor,staticProps),Constructor}var ImagePopover_ImagePopover=function(){function ImagePopover(context){var _this=this;ImagePopover_classCallCheck(this,ImagePopover),this.context=context,this.ui=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui,this.editable=context.layoutInfo.editable[0],this.options=context.options,this.events={"summernote.disable summernote.blur":function summernoteDisableSummernoteBlur(){_this.hide()}}}return ImagePopover_createClass(ImagePopover,[{key:"shouldInitialize",value:function shouldInitialize(){return!lists.isEmpty(this.options.popover.image)}},{key:"initialize",value:function initialize(){this.$popover=this.ui.popover({className:"note-image-popover"}).render().appendTo(this.options.container);var $content=this.$popover.find(".popover-content,.note-popover-content");this.context.invoke("buttons.build",$content,this.options.popover.image),this.$popover.on("mousedown",(function(e){e.preventDefault()}))}},{key:"destroy",value:function destroy(){this.$popover.remove()}},{key:"update",value:function update(target,event){if(dom.isImg(target)){var position=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(target).offset(),containerOffset=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(this.options.container).offset(),pos={};this.options.popatmouse?(pos.left=event.pageX-20,pos.top=event.pageY):pos=position,pos.top-=containerOffset.top,pos.left-=containerOffset.left,this.$popover.css({display:"block",left:pos.left,top:pos.top})}else this.hide()}},{key:"hide",value:function hide(){this.$popover.hide()}}]),ImagePopover}();function TablePopover_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function TablePopover_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function TablePopover_createClass(Constructor,protoProps,staticProps){return protoProps&&TablePopover_defineProperties(Constructor.prototype,protoProps),staticProps&&TablePopover_defineProperties(Constructor,staticProps),Constructor}var TablePopover_TablePopover=function(){function TablePopover(context){var _this=this;TablePopover_classCallCheck(this,TablePopover),this.context=context,this.ui=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui,this.options=context.options,this.events={"summernote.mousedown":function summernoteMousedown(we,e){_this.update(e.target)},"summernote.keyup summernote.scroll summernote.change":function summernoteKeyupSummernoteScrollSummernoteChange(){_this.update()},"summernote.disable summernote.blur":function summernoteDisableSummernoteBlur(){_this.hide()}}}return TablePopover_createClass(TablePopover,[{key:"shouldInitialize",value:function shouldInitialize(){return!lists.isEmpty(this.options.popover.table)}},{key:"initialize",value:function initialize(){this.$popover=this.ui.popover({className:"note-table-popover"}).render().appendTo(this.options.container);var $content=this.$popover.find(".popover-content,.note-popover-content");this.context.invoke("buttons.build",$content,this.options.popover.table),env.isFF&&document.execCommand("enableInlineTableEditing",!1,!1),this.$popover.on("mousedown",(function(e){e.preventDefault()}))}},{key:"destroy",value:function destroy(){this.$popover.remove()}},{key:"update",value:function update(target){if(this.context.isDisabled())return!1;var isCell=dom.isCell(target);if(isCell){var pos=dom.posFromPlaceholder(target),containerOffset=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(this.options.container).offset();pos.top-=containerOffset.top,pos.left-=containerOffset.left,this.$popover.css({display:"block",left:pos.left,top:pos.top})}else this.hide();return isCell}},{key:"hide",value:function hide(){this.$popover.hide()}}]),TablePopover}();function VideoDialog_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function VideoDialog_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function VideoDialog_createClass(Constructor,protoProps,staticProps){return protoProps&&VideoDialog_defineProperties(Constructor.prototype,protoProps),staticProps&&VideoDialog_defineProperties(Constructor,staticProps),Constructor}var VideoDialog_VideoDialog=function(){function VideoDialog(context){VideoDialog_classCallCheck(this,VideoDialog),this.context=context,this.ui=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui,this.$body=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(document.body),this.$editor=context.layoutInfo.editor,this.options=context.options,this.lang=this.options.langInfo}return VideoDialog_createClass(VideoDialog,[{key:"initialize",value:function initialize(){var $container=this.options.dialogsInBody?this.$body:this.options.container,body=['<div class="form-group note-form-group row-fluid">','<label for="note-dialog-video-url-'.concat(this.options.id,'" class="note-form-label">').concat(this.lang.video.url,' <small class="text-muted">').concat(this.lang.video.providers,"</small></label>"),'<input id="note-dialog-video-url-'.concat(this.options.id,'" class="note-video-url form-control note-form-control note-input" type="text"/>'),"</div>"].join(""),buttonClass,footer='<input type="button" href="#" class="'.concat("btn btn-primary note-btn note-btn-primary note-video-btn",'" value="').concat(this.lang.video.insert,'" disabled>');this.$dialog=this.ui.dialog({title:this.lang.video.insert,fade:this.options.dialogsFade,body:body,footer:footer}).render().appendTo($container)}},{key:"destroy",value:function destroy(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()}},{key:"bindEnterKey",value:function bindEnterKey($input,$btn){$input.on("keypress",(function(event){event.keyCode===core_key.code.ENTER&&(event.preventDefault(),$btn.trigger("click"))}))}},{key:"createVideoNode",value:function createVideoNode(url){var ytRegExp=/\/\/(?:(?:www|m)\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w|-]{11})(?:(?:[\?&]t=)(\S+))?$/,ytRegExpForStart=/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/,ytMatch=url.match(ytRegExp),igRegExp=/(?:www\.|\/\/)instagram\.com\/p\/(.[a-zA-Z0-9_-]*)/,igMatch=url.match(igRegExp),vRegExp=/\/\/vine\.co\/v\/([a-zA-Z0-9]+)/,vMatch=url.match(vRegExp),vimRegExp=/\/\/(player\.)?vimeo\.com\/([a-z]*\/)*(\d+)[?]?.*/,vimMatch=url.match(vimRegExp),dmRegExp=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/,dmMatch=url.match(dmRegExp),youkuRegExp=/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/,youkuMatch=url.match(youkuRegExp),qqRegExp=/\/\/v\.qq\.com.*?vid=(.+)/,qqMatch=url.match(qqRegExp),qqRegExp2=/\/\/v\.qq\.com\/x?\/?(page|cover).*?\/([^\/]+)\.html\??.*/,qqMatch2=url.match(qqRegExp2),mp4RegExp=/^.+.(mp4|m4v)$/,mp4Match=url.match(mp4RegExp),oggRegExp=/^.+.(ogg|ogv)$/,oggMatch=url.match(oggRegExp),webmRegExp=/^.+.(webm)$/,webmMatch=url.match(webmRegExp),fbRegExp=/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/,fbMatch=url.match(fbRegExp),$video;if(ytMatch&&11===ytMatch[1].length){var youtubeId=ytMatch[1],start=0;if(void 0!==ytMatch[2]){var ytMatchForStart=ytMatch[2].match(ytRegExpForStart);if(ytMatchForStart)for(var n=[3600,60,1],i=0,r=n.length;i<r;i++)start+=void 0!==ytMatchForStart[i+1]?n[i]*parseInt(ytMatchForStart[i+1],10):0}$video=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<iframe>").attr("frameborder",0).attr("src","//www.youtube.com/embed/"+youtubeId+(start>0?"?start="+start:"")).attr("width","640").attr("height","360")}else if(igMatch&&igMatch[0].length)$video=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<iframe>").attr("frameborder",0).attr("src","https://instagram.com/p/"+igMatch[1]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true");else if(vMatch&&vMatch[0].length)$video=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<iframe>").attr("frameborder",0).attr("src",vMatch[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed");else if(vimMatch&&vimMatch[3].length)$video=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("src","//player.vimeo.com/video/"+vimMatch[3]).attr("width","640").attr("height","360");else if(dmMatch&&dmMatch[2].length)$video=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<iframe>").attr("frameborder",0).attr("src","//www.dailymotion.com/embed/video/"+dmMatch[2]).attr("width","640").attr("height","360");else if(youkuMatch&&youkuMatch[1].length)$video=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+youkuMatch[1]);else if(qqMatch&&qqMatch[1].length||qqMatch2&&qqMatch2[2].length){var vid=qqMatch&&qqMatch[1].length?qqMatch[1]:qqMatch2[2];$video=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","310").attr("width","500").attr("src","https://v.qq.com/txp/iframe/player.html?vid="+vid+"&amp;auto=0")}else if(mp4Match||oggMatch||webmMatch)$video=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<video controls>").attr("src",url).attr("width","640").attr("height","360");else{if(!fbMatch||!fbMatch[0].length)return!1;$video=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<iframe>").attr("frameborder",0).attr("src","https://www.facebook.com/plugins/video.php?href="+encodeURIComponent(fbMatch[0])+"&show_text=0&width=560").attr("width","560").attr("height","301").attr("scrolling","no").attr("allowtransparency","true")}return $video.addClass("note-video-clip"),$video[0]}},{key:"show",value:function show(){var _this=this,text=this.context.invoke("editor.getSelectedText");this.context.invoke("editor.saveRange"),this.showVideoDialog(text).then((function(url){_this.ui.hideDialog(_this.$dialog),_this.context.invoke("editor.restoreRange");var $node=_this.createVideoNode(url);$node&&_this.context.invoke("editor.insertNode",$node)})).fail((function(){_this.context.invoke("editor.restoreRange")}))}},{key:"showVideoDialog",value:function showVideoDialog(){var _this2=this;return external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.Deferred((function(deferred){var $videoUrl=_this2.$dialog.find(".note-video-url"),$videoBtn=_this2.$dialog.find(".note-video-btn");_this2.ui.onDialogShown(_this2.$dialog,(function(){_this2.context.triggerEvent("dialog.shown"),$videoUrl.on("input paste propertychange",(function(){_this2.ui.toggleBtn($videoBtn,$videoUrl.val())})),env.isSupportTouch||$videoUrl.trigger("focus"),$videoBtn.click((function(event){event.preventDefault(),deferred.resolve($videoUrl.val())})),_this2.bindEnterKey($videoUrl,$videoBtn)})),_this2.ui.onDialogHidden(_this2.$dialog,(function(){$videoUrl.off(),$videoBtn.off(),"pending"===deferred.state()&&deferred.reject()})),_this2.ui.showDialog(_this2.$dialog)}))}}]),VideoDialog}();function HelpDialog_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function HelpDialog_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function HelpDialog_createClass(Constructor,protoProps,staticProps){return protoProps&&HelpDialog_defineProperties(Constructor.prototype,protoProps),staticProps&&HelpDialog_defineProperties(Constructor,staticProps),Constructor}var HelpDialog_HelpDialog=function(){function HelpDialog(context){HelpDialog_classCallCheck(this,HelpDialog),this.context=context,this.ui=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui,this.$body=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(document.body),this.$editor=context.layoutInfo.editor,this.options=context.options,this.lang=this.options.langInfo}return HelpDialog_createClass(HelpDialog,[{key:"initialize",value:function initialize(){var $container=this.options.dialogsInBody?this.$body:this.options.container,body=['<p class="text-center">','<a href="http://summernote.org/" target="_blank">Summernote 0.8.18</a>  ','<a href="https://github.com/summernote/summernote" target="_blank">Project</a>  ','<a href="https://github.com/summernote/summernote/issues" target="_blank">Issues</a>',"</p>"].join("");this.$dialog=this.ui.dialog({title:this.lang.options.help,fade:this.options.dialogsFade,body:this.createShortcutList(),footer:body,callback:function callback($node){$node.find(".modal-body,.note-modal-body").css({"max-height":300,overflow:"scroll"})}}).render().appendTo($container)}},{key:"destroy",value:function destroy(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()}},{key:"createShortcutList",value:function createShortcutList(){var _this=this,keyMap=this.options.keyMap[env.isMac?"mac":"pc"];return Object.keys(keyMap).map((function(key){var command=keyMap[key],$row=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()('<div><div class="help-list-item"></div></div>');return $row.append(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<label><kbd>"+key+"</kdb></label>").css({width:180,"margin-right":10})).append(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()("<span/>").html(_this.context.memo("help."+command)||command)),$row.html()})).join("")}},{key:"showHelpDialog",value:function showHelpDialog(){var _this2=this;return external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.Deferred((function(deferred){_this2.ui.onDialogShown(_this2.$dialog,(function(){_this2.context.triggerEvent("dialog.shown"),deferred.resolve()})),_this2.ui.showDialog(_this2.$dialog)})).promise()}},{key:"show",value:function show(){var _this3=this;this.context.invoke("editor.saveRange"),this.showHelpDialog().then((function(){_this3.context.invoke("editor.restoreRange")}))}}]),HelpDialog}();function AirPopover_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function AirPopover_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function AirPopover_createClass(Constructor,protoProps,staticProps){return protoProps&&AirPopover_defineProperties(Constructor.prototype,protoProps),staticProps&&AirPopover_defineProperties(Constructor,staticProps),Constructor}var AIRMODE_POPOVER_X_OFFSET=-5,AIRMODE_POPOVER_Y_OFFSET=5,AirPopover_AirPopover=function(){function AirPopover(context){var _this=this;AirPopover_classCallCheck(this,AirPopover),this.context=context,this.ui=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui,this.options=context.options,this.hidable=!0,this.onContextmenu=!1,this.pageX=null,this.pageY=null,this.events={"summernote.contextmenu":function summernoteContextmenu(e){_this.options.editing&&(e.preventDefault(),e.stopPropagation(),_this.onContextmenu=!0,_this.update(!0))},"summernote.mousedown":function summernoteMousedown(we,e){_this.pageX=e.pageX,_this.pageY=e.pageY},"summernote.keyup summernote.mouseup summernote.scroll":function summernoteKeyupSummernoteMouseupSummernoteScroll(we,e){_this.options.editing&&!_this.onContextmenu&&(_this.pageX=e.pageX,_this.pageY=e.pageY,_this.update()),_this.onContextmenu=!1},"summernote.disable summernote.change summernote.dialog.shown summernote.blur":function summernoteDisableSummernoteChangeSummernoteDialogShownSummernoteBlur(){_this.hide()},"summernote.focusout":function summernoteFocusout(){_this.$popover.is(":active,:focus")||_this.hide()}}}return AirPopover_createClass(AirPopover,[{key:"shouldInitialize",value:function shouldInitialize(){return this.options.airMode&&!lists.isEmpty(this.options.popover.air)}},{key:"initialize",value:function initialize(){var _this2=this;this.$popover=this.ui.popover({className:"note-air-popover"}).render().appendTo(this.options.container);var $content=this.$popover.find(".popover-content");this.context.invoke("buttons.build",$content,this.options.popover.air),this.$popover.on("mousedown",(function(){_this2.hidable=!1})),this.$popover.on("mouseup",(function(){_this2.hidable=!0}))}},{key:"destroy",value:function destroy(){this.$popover.remove()}},{key:"update",value:function update(forcelyOpen){var styleInfo=this.context.invoke("editor.currentStyle");if(!styleInfo.range||styleInfo.range.isCollapsed()&&!forcelyOpen)this.hide();else{var rect={left:this.pageX,top:this.pageY},containerOffset=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(this.options.container).offset();rect.top-=containerOffset.top,rect.left-=containerOffset.left,this.$popover.css({display:"block",left:Math.max(rect.left,0)+-5,top:rect.top+5}),this.context.invoke("buttons.updateCurrentStyle",this.$popover)}}},{key:"updateCodeview",value:function updateCodeview(isCodeview){this.ui.toggleBtnActive(this.$popover.find(".btn-codeview"),isCodeview),isCodeview&&this.hide()}},{key:"hide",value:function hide(){this.hidable&&this.$popover.hide()}}]),AirPopover}();function HintPopover_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function HintPopover_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function HintPopover_createClass(Constructor,protoProps,staticProps){return protoProps&&HintPopover_defineProperties(Constructor.prototype,protoProps),staticProps&&HintPopover_defineProperties(Constructor,staticProps),Constructor}var POPOVER_DIST=5,HintPopover_HintPopover=function(){function HintPopover(context){var _this=this;HintPopover_classCallCheck(this,HintPopover),this.context=context,this.ui=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.ui,this.$editable=context.layoutInfo.editable,this.options=context.options,this.hint=this.options.hint||[],this.direction=this.options.hintDirection||"bottom",this.hints=Array.isArray(this.hint)?this.hint:[this.hint],this.events={"summernote.keyup":function summernoteKeyup(we,e){e.isDefaultPrevented()||_this.handleKeyup(e)},"summernote.keydown":function summernoteKeydown(we,e){_this.handleKeydown(e)},"summernote.disable summernote.dialog.shown summernote.blur":function summernoteDisableSummernoteDialogShownSummernoteBlur(){_this.hide()}}}return HintPopover_createClass(HintPopover,[{key:"shouldInitialize",value:function shouldInitialize(){return this.hints.length>0}},{key:"initialize",value:function initialize(){var _this2=this;this.lastWordRange=null,this.matchingWord=null,this.$popover=this.ui.popover({className:"note-hint-popover",hideArrow:!0,direction:""}).render().appendTo(this.options.container),this.$popover.hide(),this.$content=this.$popover.find(".popover-content,.note-popover-content"),this.$content.on("click",".note-hint-item",(function(e){_this2.$content.find(".active").removeClass("active"),external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(e.currentTarget).addClass("active"),_this2.replace()})),this.$popover.on("mousedown",(function(e){e.preventDefault()}))}},{key:"destroy",value:function destroy(){this.$popover.remove()}},{key:"selectItem",value:function selectItem($item){this.$content.find(".active").removeClass("active"),$item.addClass("active"),this.$content[0].scrollTop=$item[0].offsetTop-this.$content.innerHeight()/2}},{key:"moveDown",value:function moveDown(){var $current=this.$content.find(".note-hint-item.active"),$next=$current.next();if($next.length)this.selectItem($next);else{var $nextGroup=$current.parent().next();$nextGroup.length||($nextGroup=this.$content.find(".note-hint-group").first()),this.selectItem($nextGroup.find(".note-hint-item").first())}}},{key:"moveUp",value:function moveUp(){var $current=this.$content.find(".note-hint-item.active"),$prev=$current.prev();if($prev.length)this.selectItem($prev);else{var $prevGroup=$current.parent().prev();$prevGroup.length||($prevGroup=this.$content.find(".note-hint-group").last()),this.selectItem($prevGroup.find(".note-hint-item").last())}}},{key:"replace",value:function replace(){var $item=this.$content.find(".note-hint-item.active");if($item.length){var node=this.nodeFromItem($item);if(null!==this.matchingWord&&0===this.matchingWord.length)this.lastWordRange.so=this.lastWordRange.eo;else if(null!==this.matchingWord&&this.matchingWord.length>0&&!this.lastWordRange.isCollapsed()){var rangeCompute=this.lastWordRange.eo-this.lastWordRange.so-this.matchingWord.length;rangeCompute>0&&(this.lastWordRange.so+=rangeCompute)}if(this.lastWordRange.insertNode(node),"next"===this.options.hintSelect){var blank=document.createTextNode("");external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(node).after(blank),range.createFromNodeBefore(blank).select()}else range.createFromNodeAfter(node).select();this.lastWordRange=null,this.hide(),this.context.invoke("editor.focus")}}},{key:"nodeFromItem",value:function nodeFromItem($item){var hint=this.hints[$item.data("index")],item=$item.data("item"),node=hint.content?hint.content(item):item;return"string"==typeof node&&(node=dom.createText(node)),node}},{key:"createItemTemplates",value:function createItemTemplates(hintIdx,items){var hint=this.hints[hintIdx];return items.map((function(item){var $item=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()('<div class="note-hint-item"/>');return $item.append(hint.template?hint.template(item):item+""),$item.data({index:hintIdx,item:item}),$item}))}},{key:"handleKeydown",value:function handleKeydown(e){this.$popover.is(":visible")&&(e.keyCode===core_key.code.ENTER?(e.preventDefault(),this.replace()):e.keyCode===core_key.code.UP?(e.preventDefault(),this.moveUp()):e.keyCode===core_key.code.DOWN&&(e.preventDefault(),this.moveDown()))}},{key:"searchKeyword",value:function searchKeyword(index,keyword,callback){var hint=this.hints[index];if(hint&&hint.match.test(keyword)&&hint.search){var matches=hint.match.exec(keyword);this.matchingWord=matches[0],hint.search(matches[1],callback)}else callback()}},{key:"createGroup",value:function createGroup(idx,keyword){var _this3=this,$group=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()('<div class="note-hint-group note-hint-group-'+idx+'"></div>');return this.searchKeyword(idx,keyword,(function(items){(items=items||[]).length&&($group.html(_this3.createItemTemplates(idx,items)),_this3.show())})),$group}},{key:"handleKeyup",value:function handleKeyup(e){var _this4=this;if(!lists.contains([core_key.code.ENTER,core_key.code.UP,core_key.code.DOWN],e.keyCode)){var _range=this.context.invoke("editor.getLastRange"),wordRange,keyword;if("words"===this.options.hintMode){if(wordRange=_range.getWordsRange(_range),keyword=wordRange.toString(),this.hints.forEach((function(hint){if(hint.match.test(keyword))return wordRange=_range.getWordsMatchRange(hint.match),!1})),!wordRange)return void this.hide();keyword=wordRange.toString()}else wordRange=_range.getWordRange(),keyword=wordRange.toString();if(this.hints.length&&keyword){this.$content.empty();var bnd=func.rect2bnd(lists.last(wordRange.getClientRects())),containerOffset=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(this.options.container).offset();bnd&&(bnd.top-=containerOffset.top,bnd.left-=containerOffset.left,this.$popover.hide(),this.lastWordRange=wordRange,this.hints.forEach((function(hint,idx){hint.match.test(keyword)&&_this4.createGroup(idx,keyword).appendTo(_this4.$content)})),this.$content.find(".note-hint-item:first").addClass("active"),"top"===this.direction?this.$popover.css({left:bnd.left,top:bnd.top-this.$popover.outerHeight()-5}):this.$popover.css({left:bnd.left,top:bnd.top+bnd.height+5}))}else this.hide()}}},{key:"show",value:function show(){this.$popover.show()}},{key:"hide",value:function hide(){this.$popover.hide()}}]),HintPopover}();external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.extend(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote,{version:"0.8.18",plugins:{},dom:dom,range:range,lists:lists,options:{langInfo:external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.lang["en-US"],editing:!0,modules:{editor:Editor_Editor,clipboard:Clipboard_Clipboard,dropzone:Dropzone_Dropzone,codeview:Codeview_CodeView,statusbar:Statusbar_Statusbar,fullscreen:Fullscreen_Fullscreen,handle:Handle_Handle,hintPopover:HintPopover_HintPopover,autoLink:AutoLink_AutoLink,autoSync:AutoSync_AutoSync,autoReplace:AutoReplace_AutoReplace,placeholder:Placeholder_Placeholder,buttons:Buttons_Buttons,toolbar:Toolbar_Toolbar,linkDialog:LinkDialog_LinkDialog,linkPopover:LinkPopover_LinkPopover,imageDialog:ImageDialog_ImageDialog,imagePopover:ImagePopover_ImagePopover,tablePopover:TablePopover_TablePopover,videoDialog:VideoDialog_VideoDialog,helpDialog:HelpDialog_HelpDialog,airPopover:AirPopover_AirPopover},buttons:{},lang:"en-US",followingToolbar:!1,toolbarPosition:"top",otherStaticBar:"",codeviewKeepButton:!1,toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],popatmouse:!0,popover:{image:[["resize",["resizeFull","resizeHalf","resizeQuarter","resizeNone"]],["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]],link:[["link",["linkDialogShow","unlink"]]],table:[["add",["addRowDown","addRowUp","addColLeft","addColRight"]],["delete",["deleteRow","deleteCol","deleteTable"]]],air:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]],["view",["fullscreen","codeview"]]]},airMode:!1,overrideContextMenu:!1,width:null,height:null,linkTargetBlank:!0,useProtocol:!0,defaultProtocol:"http://",focus:!1,tabDisabled:!1,tabSize:4,styleWithCSS:!1,shortcuts:!0,textareaAutoSync:!0,tooltip:"auto",container:null,maxTextLength:0,blockquoteBreakingLevel:2,spellCheck:!0,disableGrammar:!1,placeholder:null,inheritPlaceholder:!1,recordEveryKeystroke:!1,historyLimit:200,showDomainOnlyForAutolink:!1,hintMode:"word",hintSelect:"after",hintDirection:"bottom",styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Helvetica","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],fontNamesIgnoreCheck:[],addDefaultFonts:!0,fontSizes:["8","9","10","11","12","14","18","24","36"],fontSizeUnits:["px","pt"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],colorsName:[["Black","Tundora","Dove Gray","Star Dust","Pale Slate","Gallery","Alabaster","White"],["Red","Orange Peel","Yellow","Green","Cyan","Blue","Electric Violet","Magenta"],["Azalea","Karry","Egg White","Zanah","Botticelli","Tropical Blue","Mischka","Twilight"],["Tonys Pink","Peach Orange","Cream Brulee","Sprout","Casper","Perano","Cold Purple","Careys Pink"],["Mandy","Rajah","Dandelion","Olivine","Gulf Stream","Viking","Blue Marguerite","Puce"],["Guardsman Red","Fire Bush","Golden Dream","Chelsea Cucumber","Smalt Blue","Boston Blue","Butterfly Bush","Cadillac"],["Sangria","Mai Tai","Buddha Gold","Forest Green","Eden","Venice Blue","Meteorite","Claret"],["Rosewood","Cinnamon","Olive","Parsley","Tiber","Midnight Blue","Valentino","Loulou"]],colorButton:{foreColor:"#000000",backColor:"#FFFF00"},lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],tableClassName:"table table-bordered",insertTableMaxSize:{col:10,row:10},dialogsInBody:!1,dialogsFade:!1,maximumImageFileSize:null,callbacks:{onBeforeCommand:null,onBlur:null,onBlurCodeview:null,onChange:null,onChangeCodeview:null,onDialogShown:null,onEnter:null,onFocus:null,onImageLinkInsert:null,onImageUpload:null,onImageUploadError:null,onInit:null,onKeydown:null,onKeyup:null,onMousedown:null,onMouseup:null,onPaste:null,onScroll:null},codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0},codeviewFilter:!1,codeviewFilterRegex:/<\/*(?:applet|b(?:ase|gsound|link)|embed|frame(?:set)?|ilayer|l(?:ayer|ink)|meta|object|s(?:cript|tyle)|t(?:itle|extarea)|xml)[^>]*?>/gi,codeviewIframeFilter:!0,codeviewIframeWhitelistSrc:[],codeviewIframeWhitelistSrcBase:["www.youtube.com","www.youtube-nocookie.com","www.facebook.com","vine.co","instagram.com","player.vimeo.com","www.dailymotion.com","player.youku.com","v.qq.com"],keyMap:{pc:{ESC:"escape",ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"linkDialog.show"},mac:{ESC:"escape",ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"linkDialog.show"}},icons:{align:"note-icon-align",alignCenter:"note-icon-align-center",alignJustify:"note-icon-align-justify",alignLeft:"note-icon-align-left",alignRight:"note-icon-align-right",rowBelow:"note-icon-row-below",colBefore:"note-icon-col-before",colAfter:"note-icon-col-after",rowAbove:"note-icon-row-above",rowRemove:"note-icon-row-remove",colRemove:"note-icon-col-remove",indent:"note-icon-align-indent",outdent:"note-icon-align-outdent",arrowsAlt:"note-icon-arrows-alt",bold:"note-icon-bold",caret:"note-icon-caret",circle:"note-icon-circle",close:"note-icon-close",code:"note-icon-code",eraser:"note-icon-eraser",floatLeft:"note-icon-float-left",floatRight:"note-icon-float-right",font:"note-icon-font",frame:"note-icon-frame",italic:"note-icon-italic",link:"note-icon-link",unlink:"note-icon-chain-broken",magic:"note-icon-magic",menuCheck:"note-icon-menu-check",minus:"note-icon-minus",orderedlist:"note-icon-orderedlist",pencil:"note-icon-pencil",picture:"note-icon-picture",question:"note-icon-question",redo:"note-icon-redo",rollback:"note-icon-rollback",square:"note-icon-square",strikethrough:"note-icon-strikethrough",subscript:"note-icon-subscript",superscript:"note-icon-superscript",table:"note-icon-table",textHeight:"note-icon-text-height",trash:"note-icon-trash",underline:"note-icon-underline",undo:"note-icon-undo",unorderedlist:"note-icon-unorderedlist",video:"note-icon-video"}}})},5:function(module,exports,__webpack_require__){},53:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_=__webpack_require__(0),external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default=__webpack_require__.n(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_),renderer=__webpack_require__(1);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var editor=renderer.a.create('<div class="note-editor note-frame card"/>'),toolbar=renderer.a.create('<div class="note-toolbar card-header" role="toolbar"/>'),editingArea=renderer.a.create('<div class="note-editing-area"/>'),codable=renderer.a.create('<textarea class="note-codable" aria-multiline="true"/>'),editable=renderer.a.create('<div class="note-editable card-block" contentEditable="true" role="textbox" aria-multiline="true"/>'),statusbar=renderer.a.create(['<output class="note-status-output" role="status" aria-live="polite"></output>','<div class="note-statusbar" role="status">','<div class="note-resizebar" aria-label="Resize">','<div class="note-icon-bar"></div>','<div class="note-icon-bar"></div>','<div class="note-icon-bar"></div>',"</div>","</div>"].join("")),airEditor=renderer.a.create('<div class="note-editor note-airframe"/>'),airEditable=renderer.a.create(['<div class="note-editable" contentEditable="true" role="textbox" aria-multiline="true"></div>','<output class="note-status-output" role="status" aria-live="polite"></output>'].join("")),buttonGroup=renderer.a.create('<div class="note-btn-group btn-group">'),dropdown=renderer.a.create('<div class="note-dropdown-menu dropdown-menu" role="list">',(function($node,options){var markup=Array.isArray(options.items)?options.items.map((function(item){var value="string"==typeof item?item:item.value||"",content=options.template?options.template(item):item,option="object"===_typeof(item)?item.option:void 0,dataValue,dataOption;return'<a class="dropdown-item" href="#" '+('data-value="'+value+'"'+(void 0!==option?' data-option="'+option+'"':""))+' role="listitem" aria-label="'+value+'">'+content+"</a>"})).join(""):options.items;$node.html(markup).attr({"aria-label":options.title}),options&&options.codeviewKeepButton&&$node.addClass("note-codeview-keep")})),dropdownButtonContents=function dropdownButtonContents(contents){return contents},dropdownCheck=renderer.a.create('<div class="note-dropdown-menu dropdown-menu note-check" role="list">',(function($node,options){var markup=Array.isArray(options.items)?options.items.map((function(item){var value="string"==typeof item?item:item.value||"",content=options.template?options.template(item):item;return'<a class="dropdown-item" href="#" data-value="'+value+'" role="listitem" aria-label="'+item+'">'+icon(options.checkClassName)+" "+content+"</a>"})).join(""):options.items;$node.html(markup).attr({"aria-label":options.title}),options&&options.codeviewKeepButton&&$node.addClass("note-codeview-keep")})),dialog=renderer.a.create('<div class="modal note-modal" aria-hidden="false" tabindex="-1" role="dialog"/>',(function($node,options){options.fade&&$node.addClass("fade"),$node.attr({"aria-label":options.title}),$node.html(['<div class="modal-dialog">','<div class="modal-content">',options.title?'<div class="modal-header"><h4 class="modal-title">'+options.title+'</h4><button type="button" class="close" data-dismiss="modal" aria-label="Close" aria-hidden="true">&times;</button></div>':"",'<div class="modal-body">'+options.body+"</div>",options.footer?'<div class="modal-footer">'+options.footer+"</div>":"","</div>","</div>"].join(""))})),popover=renderer.a.create(['<div class="note-popover popover in">','<div class="arrow"></div>','<div class="popover-content note-children-container"></div>',"</div>"].join(""),(function($node,options){var direction=void 0!==options.direction?options.direction:"bottom";$node.addClass(direction),options.hideArrow&&$node.find(".arrow").hide()})),ui_checkbox=renderer.a.create('<div class="form-check"></div>',(function($node,options){$node.html(['<label class="form-check-label"'+(options.id?' for="note-'+options.id+'"':"")+">",'<input type="checkbox" class="form-check-input"'+(options.id?' id="note-'+options.id+'"':""),options.checked?" checked":"",' aria-label="'+(options.text?options.text:"")+'"',' aria-checked="'+(options.checked?"true":"false")+'"/>'," "+(options.text?options.text:"")+"</label>"].join(""))})),icon=function icon(iconClassName,tagName){return"<"+(tagName=tagName||"i")+' class="'+iconClassName+'"></'+tagName+">"},ui_ui,bs4_ui=function ui(editorOptions){return{editor:editor,toolbar:toolbar,editingArea:editingArea,codable:codable,editable:editable,statusbar:statusbar,airEditor:airEditor,airEditable:airEditable,buttonGroup:buttonGroup,dropdown:dropdown,dropdownButtonContents:dropdownButtonContents,dropdownCheck:dropdownCheck,dialog:dialog,popover:popover,icon:icon,checkbox:ui_checkbox,options:editorOptions,palette:function palette($node,options){return renderer.a.create('<div class="note-color-palette"/>',(function($node,options){for(var contents=[],row=0,rowSize=options.colors.length;row<rowSize;row++){for(var eventName=options.eventName,colors=options.colors[row],colorsName=options.colorsName[row],buttons=[],col=0,colSize=colors.length;col<colSize;col++){var color=colors[col],colorName=colorsName[col];buttons.push(['<button type="button" class="note-color-btn"','style="background-color:',color,'" ','data-event="',eventName,'" ','data-value="',color,'" ','title="',colorName,'" ','aria-label="',colorName,'" ','data-toggle="button" tabindex="-1"></button>'].join(""))}contents.push('<div class="note-color-row">'+buttons.join("")+"</div>")}$node.html(contents.join("")),options.tooltip&&$node.find(".note-color-btn").tooltip({container:options.container||editorOptions.container,trigger:"hover",placement:"bottom"})}))($node,options)},button:function button($node,options){return renderer.a.create('<button type="button" class="note-btn btn btn-light btn-sm" tabindex="-1">',(function($node,options){options&&options.tooltip&&$node.attr({title:options.tooltip,"aria-label":options.tooltip}).tooltip({container:options.container||editorOptions.container,trigger:"hover",placement:"bottom"}).on("click",(function(e){external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default()(e.currentTarget).tooltip("hide")})),options&&options.codeviewButton&&$node.addClass("note-codeview-keep")}))($node,options)},toggleBtn:function toggleBtn($btn,isEnable){$btn.toggleClass("disabled",!isEnable),$btn.attr("disabled",!isEnable)},toggleBtnActive:function toggleBtnActive($btn,isActive){$btn.toggleClass("active",isActive)},onDialogShown:function onDialogShown($dialog,handler){$dialog.one("shown.bs.modal",handler)},onDialogHidden:function onDialogHidden($dialog,handler){$dialog.one("hidden.bs.modal",handler)},showDialog:function showDialog($dialog){$dialog.modal("show")},hideDialog:function hideDialog($dialog){$dialog.modal("hide")},createLayout:function createLayout($note){var $editor=(editorOptions.airMode?airEditor([editingArea([codable(),airEditable()])]):"bottom"===editorOptions.toolbarPosition?editor([editingArea([codable(),editable()]),toolbar(),statusbar()]):editor([toolbar(),editingArea([codable(),editable()]),statusbar()])).render();return $editor.insertAfter($note),{note:$note,editor:$editor,toolbar:$editor.find(".note-toolbar"),editingArea:$editor.find(".note-editing-area"),editable:$editor.find(".note-editable"),codable:$editor.find(".note-codable"),statusbar:$editor.find(".note-statusbar")}},removeLayout:function removeLayout($note,layoutInfo){$note.html(layoutInfo.editable.html()),layoutInfo.editor.remove(),$note.show()}}},settings=__webpack_require__(3),summernote_bs4=__webpack_require__(5);external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote=external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.extend(external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote,{ui_template:bs4_ui,interface:"bs4"}),external_root_jQuery_commonjs2_jquery_commonjs_jquery_amd_jquery_default.a.summernote.options.styleTags=["p",{title:"Blockquote",tag:"blockquote",className:"blockquote",value:"blockquote"},"pre","h1","h2","h3","h4","h5","h6"]}})}));